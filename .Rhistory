`[<-`(is.na(.), 0)
peri_pca <- data_vis_qual %>%
select(replicate, metabolite, nM)
peri_pca <- data_vis_qual %>%
pivot_wider(names_from = metabolite, values_from = nM) %>%
select(-c("treatment", "date", "triplicate", "quality", "replicate")) %>%
# column_to_rownames("replicate") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
prcomp()
autoplot(peri_pca, data = data_vis_qual, color = "treatment")
peri_pca <- data_vis_qual %>%
pivot_wider(names_from = metabolite, values_from = nM) %>%
select(-c("treatment", "date", "triplicate", "quality", "replicate")) %>%
# column_to_rownames("replicate") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
prcomp()
autoplot(peri_pca, data = data_vis_qual, color = "treatment")
autoplot(peri_pca, color = "treatment")
autoplot(peri_pca)
peri_pca <- data_vis_qual %>%
pivot_wider(names_from = metabolite, values_from = nM) %>%
select(-c("treatment", "date", "triplicate", "quality", "replicate")) %>%
# column_to_rownames("replicate") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
prcomp()
peri_pca <- data_vis_qual %>%
pivot_wider(names_from = metabolite, values_from = nM) %>%
select(-c("treatment", "date", "triplicate", "quality", "replicate")) %>%
# column_to_rownames("replicate") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
prcomp()
autoplot(peri_pca)
peri_pca_long <- data_vis_qual %>%
pivot_wider(names_from = metabolite, values_from = nM) %>%
select(-c("treatment", "date", "triplicate", "quality", "replicate")) %>%
# column_to_rownames("replicate") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
PCA(ncp = 6)
peri_pca <- data_vis_qual %>%
pivot_wider(names_from = metabolite, values_from = nM) %>%
select(-c("treatment", "date", "triplicate", "quality", "replicate")) %>%
# column_to_rownames("replicate") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
prcomp()
autoplot(peri_pca)
autoplot(peri_pca)
peri_pca_long <- data_vis_qual %>%
pivot_wider(names_from = metabolite, values_from = nM) %>%
select(-c("treatment", "date", "triplicate", "quality", "replicate")) %>%
# column_to_rownames("replicate") %>%
data.matrix() %>%
`[<-`(is.na(.), 0)
data_vis_cluster %>%
na.omit() %>%
group_by(cluster, date, treatment) %>%
filter(str_detect(treatment, "RH|RL|LH|LL")) %>%
mutate(avg_fc = mean(fold_change)) %>%
ggplot(aes(x = date, y = log2(avg_fc), color = factor(treatment, levels = level_order))) +
geom_point() +
geom_line() +
theme_bw() +
facet_wrap(~cluster) +
scale_color_manual(values = c("gold", "lightcoral","orange", "brown3"),
labels = c("6N:1P, low dose added", "6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5)) +
ylab("Average Fold Change") +
xlab("Date")
data_vis_cluster %>%
na.omit() %>%
group_by(cluster, date, treatment) %>%
# filter(str_detect(treatment, "RH|RL|LH|LL")) %>%
mutate(avg_fc = mean(fold_change)) %>%
ggplot(aes(x = date, y = log2(avg_fc), color = factor(treatment, levels = level_order))) +
geom_point() +
geom_line() +
theme_bw() +
facet_wrap(~cluster) +
scale_color_manual(values = c("mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3"),
labels = c("0N:1P, low dose Fe","0N:1P, low dose added", "0N:1P, high dose added",
"6N:1P, low dose added", "6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5)) +
ylab("Average Fold Change") +
xlab("Date")
data_vis_cluster %>%
na.omit() %>%
group_by(cluster, date, treatment) %>%
# filter(str_detect(treatment, "RH|RL|LH|LL")) %>%
mutate(avg_fc = mean(fold_change)) %>%
ggplot(aes(x = date, y = log2(avg_fc), color = factor(treatment, levels = level_order))) +
geom_point() +
geom_line() +
theme_bw() +
facet_wrap(~cluster) +
scale_color_manual(values = c("mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3"),
labels = c("0N:1P:1Fe, high dose P","0N:1P, low dose added", "0N:1P, high dose added",
"6N:1P, low dose added", "6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5)) +
ylab("Average Fold Change") +
xlab("Date")
mdsout$points %>%
as.data.frame() %>%
rownames_to_column("id") %>%
left_join(mds_data) %>%
mutate(date_fct = factor(date)) %>%
ggplot() +
geom_point(aes(x=MDS1, y=MDS2, color=factor(treatment, levels = level_order), shape = date_fct), size=4) +
scale_color_manual(values = c("plum2","mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3"),
labels = c("Control","0N:1P:1Fe, high dose P","0N:1P, low dose added", "0N:1P, high dose added",
"6N:1P, low dose added", "6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
scale_shape_discrete(name = "Date") +
theme_bw() +
ggtitle("Variation of Metabolite Concentration (nM) Across Treatments")
quant_nmds_aas <- data_vis %>%
# arrange(desc(nM)) %>%
# group_by(metabolite, replicate) %>%
# slice(1) %>%
group_by(metabolite, treatment, date) %>%
summarise(avg_nmol = mean(nM)) %>%
ungroup() %>%
# complete(metabolite, date, treatment) %>%
# mutate(avg_nmol = replace_na(avg_nmol, 0)) %>%
mutate(id = paste(date, treatment)) %>%
filter(!str_detect(treatment, "Tote")) %>%
filter(metabolite %in% aminos$metabolite)
quant_mat_aas <- quant_nmds_aas %>%
group_by(metabolite) %>%
mutate(norm_conc = rank(avg_nmol)) %>%
select(metabolite, norm_conc, id) %>%
pivot_wider(names_from = "metabolite", values_from = "norm_conc", values_fill = 0) %>%
column_to_rownames("id") %>%
data.matrix()
mdsout <- quant_mat_aas %>%
metaMDS(k = 2, autotransform = FALSE)
mds_data <- metadataframe %>%
ungroup() %>%
mutate(timepoint = str_replace_all(timepoint, "July", "-7-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "June", "-6-22")) %>%
mutate(date = as.Date(timepoint, format = "%d-%m-%y")) %>%
filter(str_detect(filename, "Smp")) %>%
mutate(treatment = str_remove(treatment, "\\d")) %>%
mutate(id = paste(date, treatment))
mdsout_aas <- quant_mat_aas %>%
metaMDS(k = 2, autotransform = FALSE)
mdsout_aas$points %>%
as.data.frame() %>%
rownames_to_column("id") %>%
left_join(mds_data) %>%
mutate(date_fct = factor(date)) %>%
ggplot() +
geom_point(aes(x=MDS1, y=MDS2, color=factor(treatment, levels = level_order), shape = date_fct), size=4) +
scale_color_manual(values = c("plum2","mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3"),
labels = c("Control","0N:1P:1Fe, high dose P","0N:1P, low dose added", "0N:1P, high dose added",
"6N:1P, low dose added", "6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
scale_shape_discrete(name = "Date") +
theme_bw() +
ggtitle("Variation of Metabolite Concentration (nM) Across Treatments")
quant_nmds_osmos <- data_vis %>%
# arrange(desc(nM)) %>%
# group_by(metabolite, replicate) %>%
# slice(1) %>%
group_by(metabolite, treatment, date) %>%
summarise(avg_nmol = mean(nM)) %>%
ungroup() %>%
# complete(metabolite, date, treatment) %>%
# mutate(avg_nmol = replace_na(avg_nmol, 0)) %>%
mutate(id = paste(date, treatment)) %>%
filter(!str_detect(treatment, "Tote")) %>%
filter(metabolite %in% osmos$metabolite)
quant_mat_osmos <- quant_nmds_osmos %>%
group_by(metabolite) %>%
mutate(norm_conc = rank(avg_nmol)) %>%
select(metabolite, norm_conc, id) %>%
pivot_wider(names_from = "metabolite", values_from = "norm_conc", values_fill = 0) %>%
column_to_rownames("id") %>%
data.matrix()
mdsout_osmos <- quant_mat_osmos %>%
metaMDS(k = 2, autotransform = FALSE)
mds_data <- metadataframe %>%
ungroup() %>%
mutate(timepoint = str_replace_all(timepoint, "July", "-7-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "June", "-6-22")) %>%
mutate(date = as.Date(timepoint, format = "%d-%m-%y")) %>%
filter(str_detect(filename, "Smp")) %>%
mutate(treatment = str_remove(treatment, "\\d")) %>%
mutate(id = paste(date, treatment))
mdsout_osmos$points %>%
as.data.frame() %>%
rownames_to_column("id") %>%
left_join(mds_data) %>%
mutate(date_fct = factor(date)) %>%
ggplot() +
geom_point(aes(x=MDS1, y=MDS2, color=factor(treatment, levels = level_order), shape = date_fct), size=4) +
scale_color_manual(values = c("plum2","mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3"),
labels = c("Control","0N:1P:1Fe, high dose P","0N:1P, low dose added", "0N:1P, high dose added",
"6N:1P, low dose added", "6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
scale_shape_discrete(name = "Date") +
theme_bw() +
ggtitle("Variation of Metabolite Concentration (nM) Across Treatments")
quant_nmds_nucleos <- data_vis %>%
# arrange(desc(nM)) %>%
# group_by(metabolite, replicate) %>%
# slice(1) %>%
group_by(metabolite, treatment, date) %>%
summarise(avg_nmol = mean(nM)) %>%
ungroup() %>%
# complete(metabolite, date, treatment) %>%
# mutate(avg_nmol = replace_na(avg_nmol, 0)) %>%
mutate(id = paste(date, treatment)) %>%
filter(!str_detect(treatment, "Tote")) %>%
filter(metabolite %in% nucleos$metabolite)
quant_mat_nucleos <- quant_nmds_nucleos %>%
group_by(metabolite) %>%
mutate(norm_conc = rank(avg_nmol)) %>%
select(metabolite, norm_conc, id) %>%
pivot_wider(names_from = "metabolite", values_from = "norm_conc", values_fill = 0) %>%
column_to_rownames("id") %>%
data.matrix()
mdsout_nucleos <- quant_mat_nucleos %>%
metaMDS(k = 2, autotransform = FALSE)
mds_data <- metadataframe %>%
ungroup() %>%
mutate(timepoint = str_replace_all(timepoint, "July", "-7-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "June", "-6-22")) %>%
mutate(date = as.Date(timepoint, format = "%d-%m-%y")) %>%
filter(str_detect(filename, "Smp")) %>%
mutate(treatment = str_remove(treatment, "\\d")) %>%
mutate(id = paste(date, treatment))
mdsout_nucleos$points %>%
as.data.frame() %>%
rownames_to_column("id") %>%
left_join(mds_data) %>%
mutate(date_fct = factor(date)) %>%
ggplot() +
geom_point(aes(x=MDS1, y=MDS2, color=factor(treatment, levels = level_order), shape = date_fct), size=4) +
scale_color_manual(values = c("plum2","mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3"),
labels = c("Control","0N:1P:1Fe, high dose P","0N:1P, low dose added", "0N:1P, high dose added",
"6N:1P, low dose added", "6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
scale_shape_discrete(name = "Date") +
theme_bw() +
ggtitle("Variation of Metabolite Concentration (nM) Across Treatments")
quant_nmds_sulf <- data_vis %>%
# arrange(desc(nM)) %>%
# group_by(metabolite, replicate) %>%
# slice(1) %>%
group_by(metabolite, treatment, date) %>%
summarise(avg_nmol = mean(nM)) %>%
ungroup() %>%
# complete(metabolite, date, treatment) %>%
# mutate(avg_nmol = replace_na(avg_nmol, 0)) %>%
mutate(id = paste(date, treatment)) %>%
filter(!str_detect(treatment, "Tote")) %>%
filter(metabolite %in% sulfur$metabolite)
quant_mat_sulf <- quant_nmds_sulf %>%
group_by(metabolite) %>%
mutate(norm_conc = rank(avg_nmol)) %>%
select(metabolite, norm_conc, id) %>%
pivot_wider(names_from = "metabolite", values_from = "norm_conc", values_fill = 0) %>%
column_to_rownames("id") %>%
data.matrix()
mdsout_sulf <- quant_mat_sulf %>%
metaMDS(k = 2, autotransform = FALSE)
mds_data <- metadataframe %>%
ungroup() %>%
mutate(timepoint = str_replace_all(timepoint, "July", "-7-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "June", "-6-22")) %>%
mutate(date = as.Date(timepoint, format = "%d-%m-%y")) %>%
filter(str_detect(filename, "Smp")) %>%
mutate(treatment = str_remove(treatment, "\\d")) %>%
mutate(id = paste(date, treatment))
mdsout_sulf$points %>%
as.data.frame() %>%
rownames_to_column("id") %>%
left_join(mds_data) %>%
mutate(date_fct = factor(date)) %>%
ggplot() +
geom_point(aes(x=MDS1, y=MDS2, color=factor(treatment, levels = level_order), shape = date_fct), size=4) +
scale_color_manual(values = c("plum2","mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3"),
labels = c("Control","0N:1P:1Fe, high dose P","0N:1P, low dose added", "0N:1P, high dose added",
"6N:1P, low dose added", "6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
scale_shape_discrete(name = "Date") +
theme_bw() +
ggtitle("Variation of Metabolite Concentration (nM) Across Treatments")
mdsout_aas$points %>%
as.data.frame() %>%
rownames_to_column("id") %>%
left_join(mds_data) %>%
mutate(date_fct = factor(date)) %>%
ggplot() +
geom_point(aes(x=MDS1, y=MDS2, color=factor(treatment, levels = level_order), shape = date_fct), size=4) +
scale_color_manual(values = c("plum2","mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3"),
labels = c("Control","0N:1P:1Fe, high dose P","0N:1P, low dose added", "0N:1P, high dose added",
"6N:1P, low dose added", "6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
scale_shape_discrete(name = "Date") +
theme_bw() +
ggtitle("Amino Acid Concentration (nM) Across Treatments")
mdsout_osmos$points %>%
as.data.frame() %>%
rownames_to_column("id") %>%
left_join(mds_data) %>%
mutate(date_fct = factor(date)) %>%
ggplot() +
geom_point(aes(x=MDS1, y=MDS2, color=factor(treatment, levels = level_order), shape = date_fct), size=4) +
scale_color_manual(values = c("plum2","mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3"),
labels = c("Control","0N:1P:1Fe, high dose P","0N:1P, low dose added", "0N:1P, high dose added",
"6N:1P, low dose added", "6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
scale_shape_discrete(name = "Date") +
theme_bw() +
ggtitle("Osmolyte Concentration (nM) Across Treatments")
mdsout_nucleos$points %>%
as.data.frame() %>%
rownames_to_column("id") %>%
left_join(mds_data) %>%
mutate(date_fct = factor(date)) %>%
ggplot() +
geom_point(aes(x=MDS1, y=MDS2, color=factor(treatment, levels = level_order), shape = date_fct), size=4) +
scale_color_manual(values = c("plum2","mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3"),
labels = c("Control","0N:1P:1Fe, high dose P","0N:1P, low dose added", "0N:1P, high dose added",
"6N:1P, low dose added", "6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
scale_shape_discrete(name = "Date") +
theme_bw() +
ggtitle("Nucleic Acid Concentration (nM) Across Treatments")
View(data_vis_cluster)
data_vis_cluster %>%
filter(cluster == 1)
data_vis_cluster %>%
filter(cluster == 1) %>%
group_by(metabolite, date, treatment) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date, y = avg_nmol, group = metabolite, color = treatment))
data_vis_cluster %>%
filter(cluster == 1) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date_fct, y = avg_nmol, group = metabolite)) +
facet_wrap(~treatment)
data_vis_cluster %>%
filter(cluster == 1) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date_fct, y = avg_nmol, color = metabolite)) +
facet_wrap(~treatment)
data_vis_cluster %>%
filter(cluster == 1) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date_fct, y = avg_nmol, color = metabolite)) +
facet_wrap(~treatment) +
theme(legend.position = "none")
data_vis_cluster %>%
filter(cluster == 1) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date_fct, y = avg_nmol)) +
facet_wrap(~treatment) +
theme(legend.position = "none")
data_vis_cluster %>%
filter(cluster == 1) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date, y = avg_nmol, group = metabolite)) +
facet_wrap(~treatment)
data_vis_cluster %>%
filter(cluster == 1) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date, y = avg_nmol, fill = metabolite)) +
facet_wrap(~treatment)
data_vis_cluster %>%
filter(cluster == 1) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date, y = avg_nmol, color = metabolite)) +
facet_wrap(~treatment)
data_vis_cluster %>%
filter(cluster == 1) %>%
filter(metabolite %in% aminos$metabolite) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date, y = avg_nmol, color = metabolite)) +
facet_wrap(~treatment)
data_vis_cluster %>%
filter(cluster == 1) %>%
filter(metabolite %in% aminos$metabolite)
View(aminos)
data_vis_cluster %>%
filter(cluster == 1)
data_vis_cluster %>%
filter(cluster == 1) %>%
filter(metabolite %in% aminos$metabolite) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM))
data_vis_cluster %>%
filter(cluster == 1) %>%
filter(metabolite %in% aminos$metabolite)
View(data_vis_cluster)
data_vis_cluster %>%
filter(cluster == 1) %>%
filter(metabolite %in% osmos$metabolite)
data_vis_cluster %>%
filter(cluster == 1) %>%
filter(metabolite %in% osmos$metabolite) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date, y = avg_nmol, color = metabolite)) +
facet_wrap(~treatment)
data_vis_cluster %>%
filter(cluster == 1) %>%
filter(metabolite %in% nucleos$metabolite) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date, y = avg_nmol, color = metabolite)) +
facet_wrap(~treatment)
data_vis_cluster %>%
filter(cluster == 1) %>%
filter(metabolite %in% sulfur$metabolite) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date, y = avg_nmol, color = metabolite)) +
facet_wrap(~treatment)
data_vis_cluster %>%
filter(cluster == 1) %>%
# filter(metabolite %in% sulfur$metabolite) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date, y = avg_nmol, color = metabolite)) +
facet_wrap(~treatment)
data_vis_cluster %>%
filter(cluster == 1) %>%
# filter(metabolite %in% sulfur$metabolite) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date, y = avg_nmol, color = metabolite)) +
geom_point() +
facet_wrap(~treatment)
data_vis_cluster %>%
filter(cluster == 1) %>%
# filter(metabolite %in% sulfur$metabolite) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot() +
geom_line(aes(x = date, y = avg_nmol, color = metabolite)) +
geom_point(aes(x = date, y = avg_nmol, color = metabolite)) +
theme_bw() +
facet_wrap(~treatment)
data_vis_cluster %>%
filter(cluster == 1) %>%
# filter(metabolite %in% sulfur$metabolite) %>%
group_by(metabolite, date, treatment) %>%
mutate(date_fct = factor(date)) %>%
mutate(avg_nmol = mean(nM)) %>%
ggplot(aes(x = date, y = avg_nmol, color = metabolite)) +
geom_line() +
geom_point() +
theme_bw() +
facet_wrap(~treatment)

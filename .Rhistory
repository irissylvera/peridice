install.packages("maps")
find.package("maps")
library(maps)
map("state")
LA <- read.table("http://www.stat.ucla.edu/~nchristo/statistics12/la_data.txt", header = TRUE)
View(LA)
View(LA)
plot(LA$Longitude, LA$Latitude, xlab="Longitude", ylab="Latitude", main="City of Los Angeles neighborhoods")
map("county", "california", add = TRUE)
plot(LA$Schools, LA$Income)
new_LA <- LA[LA$Schools != 0]
new_LA <- LA[LA$Schools != 0,]
plot(new_LA$Schools, new_LA$Income)
View(LA)
View(LA)
library(tidyverse)
library(ggplot2)
library(RColorBrewer)
library(plotly)
install.packages("htmltools")
install.packages("htmltools")
q()
install.packages("htmltools")
install.packages("htmltools")
install.packages("htmltools")
library(plotly)
library(vegan)
library(tidyverse)
library(ggplot2)
library(RColorBrewer)
#library(plotly)
#library(vegan)
#library(heatmaply)
library(ggnewscale)
library(readr)
library(readxl)
library(corrr)
library(ggcorrplot)
#library(FactoMineR)
library(stats)
library(ggfortify)
library(ggh4x)
set.seed(20)
quant_data <- read_csv("csvs/quant_data.csv") %>%
filter(nM > 0) %>%
filter(nM < 100)
getwd()
setwd(C:/Users/dhruv/Desktop/peridice)
setwd("C:/Users/dhruv/Desktop/peridice")
getwd()
quant_data <- read_csv("csvs/quant_data.csv") %>%
filter(nM > 0) %>%
filter(nM < 100)
getwd()
setwd("C:/Users/dhruv/Desktop/peridice/")
quant_data <- read_csv("csvs/quant_data.csv") %>%
filter(nM > 0) %>%
filter(nM < 100)
setwd("C:/Users/dhruv/Desktop/peridice/peridice/")
getwd()
setwd(C:/Users/dhruv/Desktop/peridice/peridice)
setwd("C:/Users/dhruv/Desktop/peridice/peridice")
library(tidyverse)
library(readr)
library(readxl)
library(ggplot2)
# load in data
## peridice
peri <- read_csv("PERIDICE_metabolite_data.csv")
## pcpn data
pcpn <- read_xlsx("metadata/peridice_pcpn.xlsx") %>%
select(tank = Tank, treatment = Treatment2, date = Date, pn = `PN (uM)`,
pc = `PC (uM)`, cn = Cnratio,added_N_uM = AddN) %>%
mutate(triplicate = str_extract(tank, "\\d")) %>%
mutate(tank = str_remove (tank, "1/2|1/3|2/2"))  %>%
group_by(tank, date) %>%
mutate(mean_pc = mean(pc)) %>%
distinct(mean_pc, .keep_all = TRUE) %>%
mutate(replicate = paste0("230616_Smp_", ""))
# plot general metab trends
peri %>%
group_by(treatment, date) %>%
mutate(nmol = mean(nmol)) %>%
ggplot() +
geom_col(aes(x = date, y = nmol)) +
facet_wrap(~treatment)
# plot general pc/pn trends
## pc
pcpn %>%
filter(!str_detect(treatment, "Tote")) %>%
group_by(triplicate, treatment, date) %>%
ggplot(aes(x = date, y = pc, group = interaction(treatment, triplicate), color = treatment)) +
geom_line() +
geom_point() +
facet_wrap(~treatment) +
theme_bw() +
ylab("Particulate Carbon") +
xlab("Date")
## pn
pcpn %>%
filter(!str_detect(treatment, "Tote")) %>%
group_by(triplicate, treatment, date) %>%
ggplot(aes(x = date, y = pn, group = interaction(treatment, triplicate), color = treatment)) +
geom_line() +
geom_point() +
facet_wrap(~treatment) +
theme_bw() +
ylab("Particulate Nitrogen") +
xlab("Date")
pcpn %>%
filter(!str_detect(treatment, "Tote")) %>%
group_by(triplicate, treatment, date) %>%
ggplot(aes(x = date, y = cn, group = interaction(treatment, triplicate), color = treatment)) +
geom_line() +
geom_point() +
facet_wrap(~treatment) +
theme_bw() +
ylab("C:N Ratio") +
xlab("Date")
## k means
peri_km <- peri %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate")) %>%
ungroup() %>%
distinct(nmol, .keep_all = TRUE) %>%
select(metabolite, nmol, filename)  %>%
pivot_wider(names_from = metabolite, values_from = nmol) %>%
column_to_rownames("filename") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
scale() %>%
t() %>%
kmeans(centers = 10) %>%
pluck("cluster") %>%
as.data.frame() %>%
set_names("cluster") %>%
rownames_to_column("metabolite")
peri_cluster <- peri %>%
left_join(peri_km, by = c("metabolite")) %>%
mutate(cluster = factor(cluster)) %>%
na.omit()
## compare to PC
peri_cluster %>%
group_by(cluster, treatment, date) %>%
mutate(nmol = mean(nmol)) %>%
ggplot() +
geom_line(aes(x = date, y = nmol, color = cluster)) +
facet_wrap(~treatment, scales = "free")+
theme_bw()
peri_cluster %>%
filter(cluster == 2) %>%
group_by(metabolite, treatment, date) %>%
mutate(nmol = mean(nmol)) %>%
ggplot() +
geom_line(aes(x = date, y = nmol, color = metabolite)) +
facet_wrap(~treatment)+
theme_bw()
peri_cluster %>%
group_by(metabolite, treatment, date) %>%
mutate(nmol = mean(nmol)) %>%
distinct(nmol, .keep_all = TRUE) %>%
ggplot() +
geom_line(aes(x = factor(date), y = nmol, group = metabolite, color = metabolite)) +
facet_wrap(~treatment)+
theme_bw()
peri %>%
ggplot() +
geom_point(aes(x = nmol, y = pc)) +
facet_wrap(~metabolite)
pc_metabs <- data.frame(metabolite = c("Dimethylsulfoniopropionate",
"L-Alanine", "L-Glutamine"))
peri %>%
filter(metabolite %in% pc_metabs$metabolite) %>%
ggplot() +
geom_point(aes(x = nmol, y = pc, color = treatment)) +
facet_wrap(~metabolite, scales = "free")
peri %>%
filter(metabolite %in% pc_metabs$metabolite) %>%
ggplot() +
geom_point(aes(x = nmol, y = pc, color = treatment)) +
facet_wrap(~metabolite, scales = "free") +
theme_bw()
peri %>%
ggplot() +
geom_point(aes(x = nmol, y = pn)) +
facet_wrap(~metabolite)
pn_metabs <- data.frame(metabolite = c("2-O-alpha-D-Glucosylglycerol",
" Dimethylsulfoniopropionate",
"Gonyol", "L-Alanine", "L-Aspartic acid",
"L-Glutamine", "L-Leucine"))
peri %>%
filter(metabolite %in% pn_metabs$metabolite) %>%
ggplot() +
geom_point(aes(x = nmol, y = pn, color = treatment)) +
facet_wrap(~metabolite, scales = "free") +
theme_bw()
peri %>%
filter(str_detect(metabolite, "Glycerophosphocholine")) %>%
# mutate(trend = ifelse(treatment %in% c("LH|LL|ZL" > "RH|RL|ZH"),"red","blue")) %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("RH", "LH", "RL", "LL", "ZH", "ZF", "ZL", "C")),
y = nmol, fill = metabolite)) +
facet_wrap(~date, scales = "free") +
theme_bw() +
ggtitle("phytos")

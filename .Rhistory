geom_bar(aes(x = replicate, y = area_with_qc, color = RunType), stat = "identity", position = "dodge")  +
facet_wrap( ~metabolite, scales = "free_y") +
theme(axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
legend.position = "top",
strip.text = element_text(size = 10)) +
ggtitle("Internal Standard Raw Areas")
data_long <- data_no_is %>%
select(replicate, metabolite, area_with_qc) %>%
filter(str_detect(replicate, "Poo")) %>%
group_by(replicate) %>%
rename(poo_area = area_with_qc) %>%
na.omit()
data_long <- data_no_is %>%
select(replicate, metabolite, area_with_qc) %>%
filter(str_detect(replicate, "Poo")) %>%
group_by(replicate) %>%
rename(poo_area = area_with_qc) %>%
na.omit()
is_areas <- is_stds_data %>%
filter(str_detect(replicate, "Poo")) %>%
mutate(area_with_qc = ifelse(str_detect(replicate, "Half"), area_with_qc*2, area_with_qc)) %>%
filter(!str_detect(metabolite, "Inj_vol")) %>%
select(-c(metabolite, a, RunType, c, d)) %>%
group_by(replicate) %>%
rename(int_area = area_with_qc) %>%
rename(internal_standard = metabolite) %>%
group_by(internal_standard) %>%
mutate(avg_is_area = mean(int_area))
is_areas_smp <- is_stds_data %>%
filter(str_detect(replicate, "Smp")) %>%
mutate(area_with_qc = ifelse(str_detect(replicate, "Half"), area_with_qc*2, area_with_qc)) %>%
filter(!str_detect(metabolite, "Inj_vol")) %>%
select(-c(metabolite, a, RunType, c, d)) %>%
group_by(replicate) %>%
rename(int_area = area_with_qc) %>%
rename(internal_standard = metabolite) %>%
group_by(internal_standard) %>%
mutate(avg_is_area = mean(int_area))
is_conc <- internal_standards %>%
select(Compound_Name_Figure, Concentration_uM) %>%
rename(internal_standard = Compound_Name_Figure) %>%
rename(conc_um = Concentration_uM) %>%
mutate(internal_standard = str_remove(internal_standard, ", .*")) %>%
mutate(internal_standard = str_remove(internal_standard, "D"))
is_areas_inj_vol <- is_stds_data %>%
filter(str_detect(replicate, "Poo")) %>%
mutate(inj_vol = ifelse(str_detect(replicate, "Half"), 0.5, 1)) %>%
# filter(!str_detect(metabolite, "Inj_vol")) %>%
select(-c(metabolite, a, RunType, c, d)) %>%
group_by(replicate) %>%
rename(internal_standard = metabolite) %>%
group_by(internal_standard) %>%
filter(internal_standard != "Inj_vol")
isologs <- data_no_is %>%
select(replicate, metabolite, area_with_qc) %>%
left_join(is_areas_smp, by = c("replicate")) %>%
mutate(internal_standard = str_remove(internal_standard, ", .*")) %>%
mutate(internal_standard = str_remove(internal_standard, "D")) %>%
filter(metabolite %in% internal_standard) %>%
mutate(replicate = str_remove(replicate, "230616_"))
isologs_quant <- isologs %>%
left_join(is_conc, by = c("internal_standard")) %>%
left_join(metadata_targ, by = c("replicate")) %>%
filter(metabolite == internal_standard) %>%
#  mutate(area_with_qc = area_with_qc / pc_um) %>%
mutate(umol_per_vial = (area_with_qc/int_area)*conc_um) %>%
mutate(umol_enviro = umol_per_vial*400*1e-6/vol_L_filt*1000) %>%
select(replicate, metabolite, treatment, area_with_qc, date, umol_enviro) %>%
mutate(nmol_enviro = umol_enviro*1000)
isologs_quant %>%
filter(metabolite == "Trimethylamine N-oxide") %>%
group_by(treatment, date, metabolite) %>%
mutate(avg_umol_enviro = mean(umol_enviro)) %>%
distinct(avg_umol_enviro, .keep_all = TRUE) %>%
ggplot() +
geom_line(aes(x = date, y = avg_umol_enviro, color = treatment)) +
scale_color_manual(values = colors) +
theme_bw()
colors <- c("C" = "plum2", "LH" = "lightcoral", "LL" = "gold", "RH" = "brown3", "RL" = "orange", "T0" = "grey50",
"ZF" = "mediumpurple", "ZH" = "lightseagreen", "ZL" = "darkslategray2")
isologs_quant %>%
filter(metabolite == "Trimethylamine N-oxide") %>%
group_by(treatment, date, metabolite) %>%
mutate(avg_umol_enviro = mean(umol_enviro)) %>%
distinct(avg_umol_enviro, .keep_all = TRUE) %>%
ggplot() +
geom_line(aes(x = date, y = avg_umol_enviro, color = treatment)) +
scale_color_manual(values = colors) +
theme_bw()
isologs_quant %>%
filter(metabolite == "Trimethylamine N-oxide") %>%
group_by(treatment, date, metabolite) %>%
mutate(avg_umol_enviro = mean(umol_enviro)) %>%
distinct(avg_umol_enviro, .keep_all = TRUE) %>%
ggplot() +
geom_line(aes(x = date, y = avg_umol_enviro, color = treatment)) +
scale_color_manual(values = colors) +
theme_bw()
rsd_data <- data_long %>%
mutate(rsd_og = sd(poo_area)/mean(poo_area)) %>%
left_join(is_areas, by = c("replicate")) %>%
filter(!metabolite %in% isologs$metabolite) %>%
mutate(norm_area = poo_area/int_area*avg_is_area) %>%
group_by(metabolite, internal_standard) %>%
mutate(rsd = sd(norm_area)/mean(norm_area)) %>%
group_by(metabolite, internal_standard) %>%
mutate(rsd_imp = (rsd_og - rsd)/rsd_og)
poo_bmis <- rsd_data %>%
filter(rsd_imp > .4) %>%
arrange(desc(rsd_imp)) %>%
group_by(metabolite) %>%
slice(1) %>%
select(metabolite, internal_standard, rsd, int_area, avg_is_area) %>%
rename(bmis = internal_standard) %>%
rename(rsd_poo = rsd)
sample_long <- data_no_is %>%
select(replicate, metabolite, num_area) %>%
filter(!str_detect(replicate, "Poo|Std")) %>%
filter(!metabolite %in% isologs$metabolite) %>%
left_join(poo_bmis) %>%
na.omit() %>%
mutate(norm_area = num_area/int_area*avg_is_area) %>%
group_by(metabolite, bmis) %>%
mutate(rsd = sd(norm_area)/mean(norm_area))
sample_long %>%
ggplot() +
geom_point(aes(x = rsd_poo, y = rsd)) +
facet_wrap(~bmis)
ingalls_stds_quant <- read_csv("https://raw.githubusercontent.com/IngallsLabUW/Ingalls_Standards/master/Ingalls_Lab_Standards.csv") %>%
select(metabolite_name = Compound_Name_Figure, metabolite = Compound_Name, conc_um = Concentration_uM,
empirical_formula = Empirical_Formula, z, ion_form = Ionization_Form, mix = HILIC_Mix) %>%
# filter(z == 1) %>%
na.omit()
ingalls_stds_quant <- read_csv("https://raw.githubusercontent.com/IngallsLabUW/Ingalls_Standards/master/Ingalls_Lab_Standards.csv") %>%
select(metabolite_name = Compound_Name_Figure, metabolite = Compound_Name, conc_um = Concentration_uM,
empirical_formula = Empirical_Formula, z, ion_form = Ionization_Form, mix = HILIC_Mix) %>%
# filter(z == 1) %>%
na.omit()
filt_data_quant <- filt_data %>%
select(filename, vol_L_filt) %>%
rename(replicate = filename) %>%
mutate(replicate = str_remove(replicate, ".mzML"))
adj_bmis_data <- sample_long %>%
mutate(adj_peak_area = num_area/(int_area/avg_is_area)) %>%
full_join(peak_list) %>%
select(replicate, metabolite, bmis, adj_peak_area) %>%
mutate(replicate = str_remove(replicate, "230616_"))
rfs_mix1 <- peak_list %>%
mutate(replicate = str_remove(replicate, "230213_")) %>%
filter(str_detect(replicate, "Std")) %>%
select(replicate, metabolite, num_area) %>%
left_join(ingalls_stds_quant, by = c("metabolite")) %>%
na.omit() %>%
mutate(std_type = str_extract(replicate, "InH2O|InMatrix|H2OinMatrix_1|H2OinMatrix_2")) %>%
group_by(metabolite, std_type) %>%
filter(mix == "Mix1") %>%
# filter(std_type == "H2OinMatrix_1") %>%
filter(!str_detect(replicate, "Mix2")) %>%
filter(!str_detect(std_type, "H2OinMatrix_2")) %>%
# need to calculate RFs based on mix
reframe(mean_area = mean(num_area, na.rm = TRUE), conc_um = unique(conc_um)) %>%
pivot_wider(names_from = std_type, values_from = mean_area) %>%
mutate(rf_h2o = InH2O/conc_um) %>%
mutate(rf_mat = (InMatrix - H2OinMatrix_1)/conc_um) %>%
mutate(rf_ratio = rf_mat / rf_h2o) %>%
na.omit() %>%
rename(H2OinMatrix = H2OinMatrix_1)
rfs_mix2 <- peak_list %>%
mutate(replicate = str_remove(replicate, "230213_")) %>%
filter(str_detect(replicate, "Std")) %>%
select(replicate, metabolite, num_area) %>%
left_join(ingalls_stds_quant, by = c("metabolite")) %>%
na.omit() %>%
mutate(std_type = str_extract(replicate, "InH2O|InMatrix|H2OinMatrix_1|H2OinMatrix_2")) %>%
group_by(metabolite, std_type) %>%
filter(mix == "Mix2") %>%
filter(!str_detect(replicate, "Mix1")) %>%
filter(!str_detect(std_type, "H2OinMatrix_1")) %>%
# need to calculate RFs based on mix
reframe(mean_area = mean(num_area, na.rm = TRUE), conc_um = unique(conc_um)) %>%
pivot_wider(names_from = std_type, values_from = mean_area) %>%
mutate(rf_h2o = InH2O/conc_um) %>%
mutate(rf_mat = (InMatrix - H2OinMatrix_2)/conc_um) %>%
mutate(rf_ratio = rf_mat / rf_h2o) %>%
na.omit() %>%
rename(H2OinMatrix = H2OinMatrix_2)
rfs <- rfs_mix1 %>%
rbind(rfs_mix2)
quant_data <- peak_list %>%
mutate(replicate = str_remove(replicate, "230213_")) %>%
left_join(adj_bmis_data) %>%
mutate(real_area = ifelse(is.na(adj_peak_area), num_area, adj_peak_area)) %>%
select(metabolite, replicate, bmis, real_area) %>%
mutate(bmis = replace_na(bmis, "None")) %>%
left_join(rfs) %>%
select(metabolite, replicate, bmis, real_area, rf_h2o, rf_mat, rf_ratio) %>%
mutate(uM = real_area/rf_h2o * 0.0004/2 * 1/rf_ratio) %>%
mutate(nM = uM*1000) %>%
## need to left_join with filt_data
# mutate(umol_in_enviro = umol_in_vial * 400 * 10e-6/2) %>%
na.omit() %>%
filter(!metabolite %in% ingalls_standards$internal_standards) %>%
filter(metabolite != "DL-Histidine, 15N") %>%
filter(nM > -0.01) %>%
filter(!str_detect(replicate, "Std"))
quant_data %>%
group_by(metabolite) %>%
mutate(mean_nm=mean(nM)) %>%
arrange(desc(mean_nm)) %>%
ungroup() %>%
mutate(metabolite = fct_inorder(metabolite)) %>%
ggplot(aes(y = metabolite, x = log10(nM))) +
geom_boxplot() +
theme_bw()
write.csv(quant_data, file = "csvs/quant_data.csv", row.names = FALSE)
write.csv(quant_data, file = "../csvs/quant_data.csv", row.names = FALSE)
write.csv(metadataframe, file = "../csvs/metadataframe.csv", row.names = FALSE)
data_vis <- quant_data %>%
mutate(treatment = str_extract(replicate, "Std|Poo|Blk|C|ZF|ZL|ZH|RL|RH|LL|LH|Tote")) %>%
mutate(timepoint = str_extract(replicate, "27June|30June|14July|21July|27July")) %>%
mutate(timepoint = str_replace_all(timepoint, "14July", "7-14-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "21July", "7-21-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "30June", "6-30-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "27July", "7-27-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "27June", "6-27-22")) %>%
mutate(date = as.Date(timepoint, format = "%m-%d-%y")) %>%
select(metabolite, replicate, uM, nM, treatment, date) %>%
na.omit() %>%
filter(nM != "Inf")
data_vis %>%
group_by(metabolite, treatment, date) %>%
mutate(nmol_avg = mean(nM)) %>%
distinct(nmol_avg, .keep_all = TRUE) %>%
filter(nM >= 0.5) %>%
ggplot() +
geom_col(aes(x = treatment, y = nmol_avg, fill = metabolite), position = "fill") +
scale_fill_manual(values = mycolors) +
facet_wrap(~date) +
guides(fill=guide_legend(ncol=2)) +
theme_bw()
nb.cols <- 55
mycolors <- colorRampPalette(brewer.pal(8, "Set1"))(nb.cols)
data_vis %>%
group_by(metabolite, treatment, date) %>%
mutate(nmol_avg = mean(nM)) %>%
distinct(nmol_avg, .keep_all = TRUE) %>%
filter(nM >= 0.5) %>%
ggplot() +
geom_col(aes(x = treatment, y = nmol_avg, fill = metabolite), position = "fill") +
scale_fill_manual(values = mycolors) +
facet_wrap(~date) +
guides(fill=guide_legend(ncol=2)) +
theme_bw()
unique(quant_data$metabolite)
peri <- read_csv("../csvs/quant_data.csv")
peri <- read_csv("csvs/quant_data.csv")
View(peri)
peri <- read_csv("csvs/quant_data.csv") %>%
select(metabolite, filename, nmol = nM)
peri <- read_csv("csvs/quant_data.csv") %>%
select(metabolite, filename = replicate, nmol = nM)
View(peri)
peri <- read_csv("csvs/quant_data.csv") %>%
select(metabolite, filename = replicate, nmol = nM) %>%
mutate(treatment = str_extract(filename, "C|ZL|ZF|ZH|LL|LH|RL|RH"))
View(peri)
View(peri)
peri <- read_csv("csvs/quant_data.csv") %>%
select(metabolite, filename = replicate, nmol = nM) %>%
filter(str_detect(filename, "Smp")) %>%
mutate(treatment = str_extract(filename, "C|ZL|ZF|ZH|LL|LH|RL|RH"))
peri <- read_csv("PERIDICE_metabolite_data.csv") %>%
group_by(treatment, date, triplicate) %>%
mutate(bulk_metab = sum(nmol)) %>%
mutate(nmol_per_bulk = nmol/bulk_metab)
peri <- read_csv("csvs/quant_data.csv") %>%
select(metabolite, filename = replicate, nmol = nM) %>%
filter(str_detect(filename, "Smp")) %>%
mutate(treatment = str_extract(filename, "C|ZL|ZF|ZH|LL|LH|RL|RH"))
peri <- read_csv("csvs/quant_data.csv") %>%
select(metabolite, filename = replicate, nmol = nM) %>%
filter(str_detect(filename, "Smp")) %>%
mutate(treatment = str_extract(filename, "C|ZL|ZF|ZH|LL|LH|RL|RH")) %>%
mutate(timepoint = str_extract(filename, "27June|30June|14July|21July|27July")) %>%
mutate(timepoint = str_replace_all(timepoint, "14July", "7-14-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "21July", "7-21-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "30June", "6-30-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "27July", "7-27-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "27June", "6-27-22")) %>%
mutate(date = as.Date(timepoint, format = "%m-%d-%y"))
View(peri)
peri <- read_csv("csvs/quant_data.csv") %>%
select(metabolite, filename = replicate, nmol = nM) %>%
filter(str_detect(filename, "Smp")) %>%
mutate(treatment = str_extract(filename, "C|ZL|ZF|ZH|LL|LH|RL|RH")) %>%
mutate(timepoint = str_extract(filename, "27June|30June|14July|21July|27July")) %>%
mutate(timepoint = str_replace_all(timepoint, "14July", "7-14-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "21July", "7-21-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "30June", "6-30-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "27July", "7-27-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "27June", "6-27-22")) %>%
mutate(date = as.Date(timepoint, format = "%m-%d-%y")) %>%
select(-c("timepoint"))
View(peri)
peri <- read_csv("csvs/quant_data.csv") %>%
select(metabolite, filename = replicate, nmol = nM) %>%
filter(str_detect(filename, "Smp")) %>%
mutate(treatment = str_extract(filename, "C|ZL|ZF|ZH|LL|LH|RL|RH")) %>%
mutate(timepoint = str_extract(filename, "27June|30June|14July|21July|27July")) %>%
mutate(timepoint = str_replace_all(timepoint, "14July", "7-14-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "21July", "7-21-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "30June", "6-30-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "27July", "7-27-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "27June", "6-27-22")) %>%
mutate(date = as.Date(timepoint, format = "%m-%d-%y")) %>%
select(-c("timepoint")) %>%
group_by(filename) %>%
mutate(bulk_metab = sum(nmol)) %>%
mutate(nmol_per_bulk = nmol/bulk_metab)
metab_groups <- read.csv(
"https://raw.githubusercontent.com/IngallsLabUW/Ingalls_Standards/master/Ingalls_Lab_Standards.csv",
stringsAsFactors = FALSE, header = TRUE) %>%
select(metabolite = Compound_Name, emp_form = Empirical_Formula, metab_type = Compound_Type) %>%
distinct()
peri_groups <- peri %>%
left_join(metab_groups) %>%
group_by(metab_type, treatment, date) %>%
mutate(nmol_group = mean(nmol_per_bulk))
peri_groups %>%
# filter(str_detect(metab_type, "Amino Acid")) %>%
filter(!str_detect(filename, "Tote|14|21")) %>%
ggplot() +
geom_col(aes(x = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_group,
fill = metab_type),
position = "fill") +
facet_wrap(~date, ncol = 5)
peri_groups %>%
# filter(str_detect(metab_type, "Amino Acid")) %>%
filter(!str_detect(filename, "Tote|14|21")) %>%
ggplot() +
geom_col(aes(x = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_group,
fill = metab_type),
position = "stack") +
facet_wrap(~date, ncol = 5)
peri_groups %>%
# filter(str_detect(metab_type, "Amino Acid")) %>%
filter(!str_detect(filename, "Tote|14|21")) %>%
ggplot() +
geom_col(aes(x = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_group,
fill = metab_type),
position = "stack") +
facet_wrap(~date, ncol = 5)
View(peri_groups)
peri_groups <- peri %>%
left_join(metab_groups) %>%
group_by(metab_type, treatment, date)
View(peri_groups)
peri_groups <- peri %>%
left_join(metab_groups) %>%
group_by(metab_type, treatment, date) %>%
mutate(nmol_group = mean(nmol_per_bulk))
View(peri_groups)
View(metab_groups)
peri_groups <- peri %>%
left_join(metab_groups)
View(peri_groups)
peri_groups <- peri %>%
left_join(metab_groups) %>%
group_by(metab_type, treatment, date) %>%
mutate(nmol_group = mean(nmol_per_bulk))
peri_groups %>%
# filter(str_detect(metab_type, "Amino Acid")) %>%
filter(!str_detect(filename, "Tote|14|21")) %>%
ggplot() +
geom_col(aes(x = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_group,
fill = metab_type),
position = "stack") +
facet_wrap(~date, ncol = 5)
peri_groups %>%
# filter(str_detect(metab_type, "Amino Acid")) %>%
filter(!str_detect(filename, "Tote|14|21")) %>%
ggplot() +
geom_col(aes(x = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_group,
fill = metab_type),
position = "fill") +
facet_wrap(~date, ncol = 5)
peri_groups %>%
# filter(str_detect(metab_type, "Amino Acid")) %>%
# filter(!str_detect(filename, "Tote|14|21")) %>%
ggplot() +
geom_col(aes(x = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_group,
fill = metab_type),
position = "stack") +
facet_wrap(~date, ncol = 5)
peri_groups <- peri %>%
left_join(metab_groups) %>%
group_by(metab_type, treatment, date) %>%
mutate(nmol_group = mean(nmol_per_bulk))
View(peri_groups)
peri_groups <- peri %>%
left_join(metab_groups) %>%
group_by(metab_type, treatment, date) %>%
mutate(nmol_group = mean(nmol))
peri_groups %>%
# filter(str_detect(metab_type, "Amino Acid")) %>%
# filter(!str_detect(filename, "Tote|14|21")) %>%
ggplot() +
geom_col(aes(x = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_group,
fill = metab_type),
position = "stack") +
facet_wrap(~date, ncol = 5)
peri <- read_csv("csvs/quant_data.csv") %>%
select(metabolite, filename = replicate, nmol = nM) %>%
filter(str_detect(filename, "Smp")) %>%
mutate(treatment = str_extract(filename, "C|ZL|ZF|ZH|LL|LH|RL|RH")) %>%
mutate(timepoint = str_extract(filename, "27June|30June|14July|21July|27July")) %>%
mutate(timepoint = str_replace_all(timepoint, "14July", "7-14-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "21July", "7-21-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "30June", "6-30-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "27July", "7-27-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "27June", "6-27-22")) %>%
mutate(date = as.Date(timepoint, format = "%m-%d-%y")) %>%
select(-c("timepoint")) %>%
group_by(filename) %>%
mutate(bulk_metab = sum(nmol)) %>%
ungroup() %>%
mutate(nmol_per_bulk = nmol/bulk_metab)
peri_groups <- peri %>%
left_join(metab_groups) %>%
group_by(metab_type, treatment, date) %>%
mutate(nmol_group = mean(nmol))
peri_groups <- peri %>%
left_join(metab_groups) %>%
group_by(metab_type, treatment, date) %>%
mutate(nmol_group = mean(nmol_per_bulk))
peri_groups %>%
# filter(str_detect(metab_type, "Amino Acid")) %>%
# filter(!str_detect(filename, "Tote|14|21")) %>%
ggplot() +
geom_col(aes(x = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_group,
fill = metab_type),
position = "stack") +
facet_wrap(~date, ncol = 5)
peri <- read_csv("PERIDICE_metabolite_data.csv") %>%
group_by(treatment, date, triplicate) %>%
mutate(bulk_metab = sum(nmol)) %>%
ungroup() %>%
mutate(nmol_per_bulk = nmol/bulk_metab)
peri_groups <- peri %>%
left_join(metab_groups) %>%
group_by(metab_type, treatment, date) %>%
mutate(nmol_group = mean(nmol_per_bulk))
peri_groups %>%
# filter(str_detect(metab_type, "Amino Acid")) %>%
# filter(!str_detect(filename, "Tote|14|21")) %>%
ggplot() +
geom_col(aes(x = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_group,
fill = metab_type),
position = "stack") +
facet_wrap(~date, ncol = 5)
peri_groups <- peri %>%
left_join(metab_groups) %>%
ungroup() %>%
group_by(metab_type, treatment, date) %>%
mutate(nmol_group = mean(nmol_per_bulk))
peri_groups %>%
# filter(str_detect(metab_type, "Amino Acid")) %>%
# filter(!str_detect(filename, "Tote|14|21")) %>%
ggplot() +
geom_col(aes(x = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_group,
fill = metab_type),
position = "stack") +
facet_wrap(~date, ncol = 5)
peri <- read_csv("PERIDICE_metabolite_data.csv") %>%
group_by(treatment, date, triplicate) %>%
mutate(bulk_metab = sum(nmol)) %>%
mutate(nmol_per_bulk = nmol/bulk_metab)
View(peri)
peri_groups <- peri %>%
left_join(metab_groups) %>%
group_by(metab_type, treatment, date) %>%
mutate(nmol_group = mean(nmol_per_bulk))
View(peri_groups)
peri_groups %>%
# filter(str_detect(metab_type, "Amino Acid")) %>%
# filter(!str_detect(filename, "Tote|14|21")) %>%
ggplot() +
geom_col(aes(x = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_group,
fill = metab_type),
position = "stack") +
facet_wrap(~date, ncol = 5)
peri_groups %>%
# filter(str_detect(metab_type, "Amino Acid")) %>%
# filter(!str_detect(filename, "Tote|14|21")) %>%
ggplot() +
geom_col(aes(x = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_group,
fill = metab_type),
position = "stack") +
facet_wrap(~date)

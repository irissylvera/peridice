theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peridice_osmos %>%
group_by(metabolite, treatment, date) %>%
# filter(!str_detect(treatment, "Tote")) %>%
filter(str_detect(treatment, "C|RH|RL|LH|LL")) %>%
filter(str_detect(metabolite, "2-O-alpha-D-Glucosylglycerol|Ectoine|Ethanolamine|Trimethylamine N-oxide")) %>%
ggplot(aes(x = factor(date), y = nM, color = factor(treatment, levels = level_order))) +
geom_boxplot() +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control", "Lower (than Redfield) ratio of N:P, low dose added",
"Lower (than Redfield) ratio of N:P, high dose added",
"Redfield Ratio of N:P, low dose added", "Redfield Ratio of N:P, high dose added"),
name = "Treatment") +
guides(fill=guide_legend(ncol=2)) +
theme_bw() +
xlab("Date") +
ylab("nM (nmol per L)") +
facet_wrap(~metabolite, scales = "free-y") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peridice_osmos %>%
group_by(metabolite, treatment, date) %>%
# filter(!str_detect(treatment, "Tote")) %>%
filter(str_detect(treatment, "C|RH|RL|LH|LL")) %>%
filter(str_detect(metabolite, "2-O-alpha-D-Glucosylglycerol|Ectoine|Ethanolamine|Trimethylamine N-oxide")) %>%
ggplot(aes(x = factor(date), y = nM, color = factor(treatment, levels = level_order))) +
geom_boxplot() +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control", "Lower (than Redfield) ratio of N:P, low dose added",
"Lower (than Redfield) ratio of N:P, high dose added",
"Redfield Ratio of N:P, low dose added", "Redfield Ratio of N:P, high dose added"),
name = "Treatment") +
guides(fill=guide_legend(ncol=2)) +
theme_bw() +
xlab("Date") +
ylab("nM (nmol per L)") +
facet_wrap(~metabolite, scales = "free_y") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peridice_osmos %>%
group_by(metabolite, treatment, date) %>%
# filter(!str_detect(treatment, "Tote")) %>%
filter(str_detect(treatment, "C|RH|RL|LH|LL")) %>%
filter(str_detect(metabolite, "2-O-alpha-D-Glucosylglycerol|Ectoine|Ethanolamine|Trimethylamine N-oxide")) %>%
ggplot(aes(x = factor(date), y = nM, color = factor(treatment, levels = level_order))) +
geom_boxplot() +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control", "6N:1P, low dose added",
"6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
guides(fill=guide_legend(ncol=2)) +
theme_bw() +
xlab("Date") +
ylab("nM (nmol per L)") +
facet_wrap(~metabolite, scales = "free_y") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peridice_aas %>%
group_by(metabolite, treatment, date) %>%
filter(str_detect(treatment, "C|RH|RL|LH|LL")) %>%
ggplot(aes(x = factor(date), y = nM, color = factor(treatment, levels = level_order))) +
geom_boxplot() +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control", "Lower (than Redfield) ratio of N:P, low dose added",
"Lower (than Redfield) ratio of N:P, high dose added",
"Redfield Ratio of N:P, low dose added", "Redfield Ratio of N:P, high dose added"),
name = "Treatment") +
guides(fill=guide_legend(ncol=2)) +
theme_bw() +
xlab("Date") +
ylab("nM (nmol per L)") +
facet_wrap(~metabolite, scales = "free_y") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peridice_aas %>%
group_by(metabolite, treatment, date) %>%
filter(str_detect(treatment, "C|RH|RL|LH|LL")) %>%
ggplot(aes(x = factor(date), y = nM, color = factor(treatment, levels = level_order))) +
geom_boxplot() +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control", "6N:1P, low dose added",
"6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
guides(fill=guide_legend(ncol=2)) +
theme_bw() +
xlab("Date") +
ylab("nM (nmol per L)") +
facet_wrap(~metabolite, scales = "free_y") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
mdsout$points %>%
as.data.frame() %>%
rownames_to_column("id") %>%
left_join(mds_data) %>%
mutate(date_fct = factor(date)) %>%
ggplot() +
geom_point(aes(x=MDS1, y=MDS2, color=treatment, shape = date_fct), size=4) +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control - no nutrients added", "6N:1P, low dose added",
"6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
scale_shape_discrete(name = "Date") +
theme_bw() +
ggtitle("Variation of Metabolite Concentration (nM) Across Treatments")
nucleos <- read.csv(
"https://raw.githubusercontent.com/IngallsLabUW/Ingalls_Standards/master/Ingalls_Lab_Standards.csv",
stringsAsFactors = FALSE, header = TRUE) %>%
filter(Compound_Type == "Nucleic Acid") %>%
select(metabolite = Compound_Name, emp_form = Empirical_Formula, metabolite_name = Compound_Name_Figure)
nucleos <- read.csv(
"https://raw.githubusercontent.com/IngallsLabUW/Ingalls_Standards/master/Ingalls_Lab_Standards.csv",
stringsAsFactors = FALSE, header = TRUE) %>%
filter(Compound_Type == "Nucleic Acid") %>%
select(metabolite = Compound_Name, emp_form = Empirical_Formula, metabolite_name = Compound_Name_Figure)
peridice_nucleos <- data_vis %>%
filter(metabolite %in% nucleos$metabolite)
View(peridice_nucleos)
peridice_nucleos %>%
group_by(metabolite, treatment, date) %>%
# filter(!str_detect(treatment, "Tote")) %>%
filter(str_detect(treatment, "C|RH|RL|LH|LL")) %>%
ggplot(aes(x = factor(date), y = nM, color = factor(treatment, levels = level_order))) +
geom_boxplot() +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control", "6N:1P, low dose added",
"6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
guides(fill=guide_legend(ncol=2)) +
theme_bw() +
xlab("Date") +
ylab("nM (nmol per L)") +
facet_wrap(~metabolite, scales = "free_y") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
p = (1-choose((n-k),i)/choose(n,i))
i = 1
n = 1000
k = 44
j = 0
p = 0
while (p >= 0.9) {
p = (1-choose((n-k),i)/choose(n,i))
i = i+1
j = i
}
i
j
while (p >= 0.9) {
p = (1-choose((n-k),i)/choose(n,i))
i = i+1
j = i
}
i
j
p = 1-(choose((n-k),i)/choose(n,i))
i = i+1
j = i
while (p >= 0.9) {
p = 1-(choose((n-k),i)/choose(n,i))
i = i+1
j = i
}
i
j
while (p >= 0.9) {
p = 1-(choose((n-k),i)/choose(n,i))
i = i+1
j = i
}
j
p
i=1
n=1000
k=44
j=0
p=0
while(p<.9)
{
p=1-(choose((n-k),i)/choose(n,i))
i=i+1
j=i
}
j
p
i=1
n=10000
k=444
j=0
p=0
while(p<.9)
{
p=1-(choose((n-k),i)/choose(n,i))
i=i+1
j=i
}
j
p
while(p=<.9)
{
p=1-(choose((n-k),i)/choose(n,i))
i=i+1
j=i
}
while(p<.9)
{
p=1-(choose((n-k),i)/choose(n,i))
i=i+1
j=i
}
j
p
i=1
n=10000
k=444
j=0
p=0
while(p<.9)
{
p=1-(choose((n-k),i)/choose(n,i))
i=i+1
j=i
}
j
p
i = 1
n = 1000
k = 44
j = 0
p = 0
while (p >= 0.9) {
p = 1-(choose((n-k),i)/choose(n,i))
i = i+1
j = i
}
j
p
while (p< 0.9) {
p = 1-(choose((n-k),i)/choose(n,i))
i = i+1
j = i
}
j
p
peridice_nucleos <- data_vis %>%
filter(metabolite %in% nucleos$metabolite|metabolite_name)
nucleos <- read.csv(
"https://raw.githubusercontent.com/IngallsLabUW/Ingalls_Standards/master/Ingalls_Lab_Standards.csv",
stringsAsFactors = FALSE, header = TRUE) %>%
filter(Compound_Type == "Nucleic Acid") %>%
select(metabolite = Compound_Name, emp_form = Empirical_Formula, metabolite_name = Compound_Name_Figure)
peridice_nucleos <- data_vis %>%
filter(metabolite %in% nucleos$metabolite|nucleos$metabolite_name)
peridice_nucleos <- data_vis %>%
filter(metabolite %in% nucleos$metabolite)
peridice_nucleos <- data_vis %>%
filter(metabolite %in% nucleos$metabolite_name)
peridice_nucleos <- data_vis %>%
filter(metabolite %in% nucleos$metabolite)
peridice_nucleos %>%
group_by(metabolite, treatment, date) %>%
# filter(!str_detect(treatment, "Tote")) %>%
filter(str_detect(treatment, "C|RH|RL|LH|LL")) %>%
ggplot(aes(x = factor(date), y = nM, color = factor(treatment, levels = level_order))) +
geom_boxplot() +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control", "6N:1P, low dose added",
"6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
guides(fill=guide_legend(ncol=2)) +
theme_bw() +
xlab("Date") +
ylab("nM (nmol per L)") +
facet_wrap(~metabolite, scales = "free_y") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
nucleos <- read.csv(
"https://raw.githubusercontent.com/IngallsLabUW/Ingalls_Standards/master/Ingalls_Lab_Standards.csv",
stringsAsFactors = FALSE, header = TRUE)
View(nucleos)
sulfur <- read.csv(
"https://raw.githubusercontent.com/IngallsLabUW/Ingalls_Standards/master/Ingalls_Lab_Standards.csv",
stringsAsFactors = FALSE, header = TRUE) %>%
filter(Compound_Type == "Sulfur") %>%
select(metabolite = Compound_Name, emp_form = Empirical_Formula, metabolite_name = Compound_Name_Figure)
sulfur <- read.csv(
"https://raw.githubusercontent.com/IngallsLabUW/Ingalls_Standards/master/Ingalls_Lab_Standards.csv",
stringsAsFactors = FALSE, header = TRUE) %>%
filter(Compound_Type == "Sulfur") %>%
select(metabolite = Compound_Name, emp_form = Empirical_Formula, metabolite_name = Compound_Name_Figure)
peridice_sulf <- data_vis %>%
filter(metabolite %in% sulfur$metabolite)
peridice_sulf %>%
group_by(metabolite, treatment, date) %>%
# filter(!str_detect(treatment, "Tote")) %>%
filter(str_detect(treatment, "C|RH|RL|LH|LL")) %>%
ggplot(aes(x = factor(date), y = nM, color = factor(treatment, levels = level_order))) +
geom_boxplot() +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control", "6N:1P, low dose added",
"6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
guides(fill=guide_legend(ncol=2)) +
theme_bw() +
xlab("Date") +
ylab("nM (nmol per L)") +
facet_wrap(~metabolite, scales = "free_y") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
View(sulfur)
View(peridice_nucleos)
View(peridice_sulf)
peridice_sulf <- data_vis %>%
filter(metabolite %in% sulfur$metabolite) %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate|3-Aminopropanesulfonate|3-Sulfopyruvic acid|
2-keto-4-methylthiobutyric acid|Sodium taurocholate|L-Cysteinesulfinic acid"))
peridice_sulf %>%
group_by(metabolite, treatment, date) %>%
# filter(!str_detect(treatment, "Tote")) %>%
filter(str_detect(treatment, "C|RH|RL|LH|LL")) %>%
ggplot(aes(x = factor(date), y = nM, color = factor(treatment, levels = level_order))) +
geom_boxplot() +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control", "6N:1P, low dose added",
"6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
guides(fill=guide_legend(ncol=2)) +
theme_bw() +
xlab("Date") +
ylab("nM (nmol per L)") +
facet_wrap(~metabolite, scales = "free_y") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
unique(peridice_sulf$metabolite)
peridice_sulf <- data_vis %>%
filter(metabolite %in% sulfur$metabolite) %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate|3-Aminopropanesulfonate|3-Sulfopyruvic acid|
2-keto-4-methylthiobutyric acid|Sodium taurocholate|L-Cysteinesulfinic acid|2-Hydroxy-4-(methylthio)butyric acid"))
peridice_sulf %>%
group_by(metabolite, treatment, date) %>%
# filter(!str_detect(treatment, "Tote")) %>%
filter(str_detect(treatment, "C|RH|RL|LH|LL")) %>%
ggplot(aes(x = factor(date), y = nM, color = factor(treatment, levels = level_order))) +
geom_boxplot() +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control", "6N:1P, low dose added",
"6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
guides(fill=guide_legend(ncol=2)) +
theme_bw() +
xlab("Date") +
ylab("nM (nmol per L)") +
facet_wrap(~metabolite, scales = "free_y") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peridice_sulf <- data_vis %>%
filter(metabolite %in% sulfur$metabolite) %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate|3-Aminopropanesulfonate|3-Sulfopyruvic acid|
2-keto-4-methylthiobutyric acid|Sodium taurocholate|L-Cysteinesulfinic acid|2-Hydroxy-4-(methylthio)butyric acid"))
peridice_sulf %>%
group_by(metabolite, treatment, date) %>%
# filter(!str_detect(treatment, "Tote")) %>%
filter(str_detect(treatment, "C|RH|RL|LH|LL")) %>%
ggplot(aes(x = factor(date), y = nM, color = factor(treatment, levels = level_order))) +
geom_boxplot() +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control", "6N:1P, low dose added",
"6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
guides(fill=guide_legend(ncol=2)) +
theme_bw() +
xlab("Date") +
ylab("nM (nmol per L)") +
facet_wrap(~metabolite, scales = "free_y") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peridice_sulf <- data_vis %>%
filter(metabolite %in% sulfur$metabolite) %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate|3-Aminopropanesulfonate|3-Sulfopyruvic acid|
2-keto-4-methylthiobutyric acid|Sodium taurocholate|L-Cysteinesulfinic acid|2-Hydroxy-4-(methylthio)butyric acid"))
unique(peridice_sulf$metabolite)
peridice_sulf <- data_vis %>%
filter(metabolite %in% sulfur$metabolite) %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate|3-Aminopropanesulfonate|3-Sulfopyruvic acid|
2-keto-4-methylthiobutyric acid|Sodium taurocholate|L-Cysteinesulfinic acid|2-Hydroxy-4-(methylthio)butyric acid"))
unique(peridice_sulf$metabolite)
peridice_sulf <- data_vis %>%
filter(metabolite %in% sulfur$metabolite) %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate|3-Aminopropanesulfonate|3-Sulfopyruvic acid|2-keto-4-methylthiobutyric acid|Sodium taurocholate|L-Cysteinesulfinic acid|2-Hydroxy-4-(methylthio)butyric acid"))
unique(peridice_sulf$metabolite)
peridice_sulf <- data_vis %>%
filter(metabolite %in% sulfur$metabolite) %>%
filter(metabolite != "2-Hydroxy-4-(methylthio)butyric acid")
unique(peridice_sulf$metabolite)
peridice_sulf <- data_vis %>%
filter(metabolite %in% sulfur$metabolite) %>%
filter(metabolite != "2-Hydroxy-4-(methylthio)butyric acid|L-Cysteinesulfinic acid")
unique(peridice_sulf$metabolite)
peridice_sulf <- data_vis %>%
filter(metabolite %in% sulfur$metabolite) %>%
filter(metabolite != "2-Hydroxy-4-(methylthio)butyric acid|L-Cysteinesulfinic acid")
unique(peridice_sulf$metabolite)
peridice_sulf <- data_vis %>%
filter(metabolite %in% sulfur$metabolite) %>%
filter(metabolite != "2-Hydroxy-4-(methylthio)butyric acid|")
peridice_sulf <- data_vis %>%
filter(metabolite %in% sulfur$metabolite) %>%
filter(metabolite != "2-Hydroxy-4-(methylthio)butyric acid") %>%
filter(metavolite != "L-Cysteinesulfinic acid")
peridice_sulf <- data_vis %>%
filter(metabolite %in% sulfur$metabolite) %>%
filter(metabolite != "2-Hydroxy-4-(methylthio)butyric acid") %>%
filter(metabolite != "L-Cysteinesulfinic acid") %>%
filter(metabolite != "Sodium taurocholate") %>%
filter(metabolite != "Amino hydroxypropanesulfonate") %>%
filter(metabolite != "3-Aminopropanesulfonate") %>%
filter(metabolite != "3-Sulfopyruvic acid") %>%
filter(metabolite != "2-keto-4-methylthiobutyric acid")
peridice_sulf %>%
group_by(metabolite, treatment, date) %>%
# filter(!str_detect(treatment, "Tote")) %>%
filter(str_detect(treatment, "C|RH|RL|LH|LL")) %>%
ggplot(aes(x = factor(date), y = nM, color = factor(treatment, levels = level_order))) +
geom_boxplot() +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control", "6N:1P, low dose added",
"6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
guides(fill=guide_legend(ncol=2)) +
theme_bw() +
xlab("Date") +
ylab("nM (nmol per L)") +
facet_wrap(~metabolite, scales = "free_y") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peridice_sulf %>%
group_by(metabolite, treatment, date) %>%
# filter(!str_detect(treatment, "Tote")) %>%
filter(str_detect(treatment, "C|RH|RL|LH|LL")) %>%
ggplot(aes(x = factor(date), y = nM, color = factor(treatment, levels = level_order))) +
geom_boxplot() +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control", "6N:1P, low dose added",
"6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
guides(fill=guide_legend(ncol=2)) +
theme_bw() +
xlab("Date") +
ylab("nM (nmol per L)") +
facet_wrap(~metabolite, scales = "free_y") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5)) +
ggtitle("Sulfur-containing Compounds")
peridice_sulf %>%
group_by(metabolite, treatment, date) %>%
# filter(!str_detect(treatment, "Tote")) %>%
filter(str_detect(treatment, "C|RH|RL|LH|LL")) %>%
ggplot(aes(x = factor(date), y = nM, color = factor(treatment, levels = level_order))) +
geom_boxplot() +
scale_color_manual(values = c("plum2", "gold", "lightcoral", "orange", "brown3"),
labels = c("Control", "6N:1P, low dose added",
"6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
guides(fill=guide_legend(ncol=2)) +
theme_bw() +
xlab("Date") +
ylab("nM (nmol per L)") +
facet_wrap(~metabolite, scales = "free_y") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5)) +
ggtitle("Concentrations of Sulfur-Containing Compounds")
data_vis_cluster %>%
na.omit() %>%
group_by(cluster, date, treatment) %>%
filter(str_detect(treatment, "RH|RL|LH|LL")) %>%
mutate(avg_fc = mean(fold_change)) %>%
ggplot(aes(x = date, y = avg_fc, color = factor(treatment, levels = level_order))) +
geom_point() +
geom_line() +
theme_bw() +
facet_wrap(~cluster) +
scale_color_manual(values = c("gold", "lightcoral", "orange", "brown3"),
labels = c("6N:1P, low dose added", "6N:1P, high dose added",
"6N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
data_vis_cluster <- data_vis_fc %>%
left_join(data_vis_km) %>%
rename(control = C, treatment = name, nM = value) %>%
mutate(cluster = factor(cluster)) %>%
filter(!str_detect(treatment, "Tote|ZF|ZL|ZH"))
View(data_vis_cluster)
head(data_vis_cluster)
data_vis_cluster <- data_vis_fc %>%
left_join(data_vis_km) %>%
rename(control = C, treatment = name, nM = value) %>%
mutate(cluster = factor(cluster)) %>%
filter(!str_detect(treatment, "Tote|ZF|ZL|ZH")) %>%
mutate(metabolite = factor(metabolite, levels = with(cluster, labels[order])))
data_vis_cluster <- data_vis_fc %>%
left_join(data_vis_km) %>%
rename(control = C, treatment = name, nM = value) %>%
mutate(cluster = factor(cluster)) %>%
filter(!str_detect(treatment, "Tote|ZF|ZL|ZH")) %>%
mutate(metabolite = factor(metabolite, levels = with(cluster)))
data_vis_cluster <- data_vis_fc %>%
left_join(data_vis_km) %>%
rename(control = C, treatment = name, nM = value) %>%
mutate(cluster = factor(cluster)) %>%
filter(!str_detect(treatment, "Tote|ZF|ZL|ZH"))
data_vis_cluster <- data_vis_fc %>%
left_join(data_vis_km) %>%
rename(control = C, treatment = name, nM = value) %>%
mutate(cluster = factor(cluster)) %>%
filter(!str_detect(treatment, "Tote|ZF|ZL|ZH"))

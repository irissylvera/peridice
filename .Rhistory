geom_point(aes(color = rate), size = 0.75) +
geom_polygon(aes(fill = rate), alpha = 0.5) +
# scale_fill_continuous(values = mycolors) +
theme_bw() +
facet_grid2(~factor(ratio, levels = c("0N:1P", "6N:1P", "16N:1P"))~date, scales = "free", independent = "y")  +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5, size = 7), axis.text.y = element_text(size = 7))
peri_pca_analysis %>%
mutate(rate = str_replace(rate, "H", "High Dose of Nutrients")) %>%
mutate(rate = str_replace(rate, "L", "Low Dose of Nutrients")) %>%
mutate(rate = str_replace(rate, "F", "High Dose of Nutrients-no Fe")) %>%
# filter(str_detect(replicate, "21July")) %>%
filter(str_detect(ratio, "R|L|Z|C")) %>%
# filter(str_detect(rate, "H|L")) %>%
mutate(ratio = str_replace(ratio, "R", "16N:1P")) %>%
mutate(ratio = str_replace(ratio, "L", "6N:1P")) %>%
mutate(ratio = str_replace(ratio, "Z", "0N:1P")) %>%
ggplot(aes(x = PC1, y = PC2, group = rate)) +
geom_point(aes(color = rate), size = 0.75) +
geom_polygon(aes(fill = rate), alpha = 0.5) +
# scale_fill_continuous(values = mycolors) +
theme_bw() +
facet_grid2(~factor(ratio, levels = c("0N:1P", "6N:1P", "16N:1P"))~date, scales = "free", independent = "y")  +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5, size = 7), axis.text.y = element_text(size = 7))
peri_pca_analysis %>%
mutate(rate = str_replace(rate, "H", "High Dose of Nutrients")) %>%
mutate(rate = str_replace(rate, "L", "Low Dose of Nutrients")) %>%
mutate(rate = str_replace(rate, "F", "High Dose of Nutrients-no Fe")) %>%
# filter(str_detect(replicate, "21July")) %>%
filter(str_detect(ratio, "R|L|Z")) %>%
# filter(str_detect(rate, "H|L")) %>%
mutate(ratio = str_replace(ratio, "R", "16N:1P")) %>%
mutate(ratio = str_replace(ratio, "L", "6N:1P")) %>%
mutate(ratio = str_replace(ratio, "Z", "0N:1P")) %>%
ggplot(aes(x = PC1, y = PC2, group = rate)) +
geom_point(aes(color = rate), size = 0.75) +
geom_polygon(aes(fill = rate), alpha = 0.5) +
# scale_fill_continuous(values = mycolors) +
theme_bw() +
facet_grid2(~factor(ratio, levels = c("0N:1P", "6N:1P", "16N:1P"))~date, scales = "free", independent = "y")  +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5, size = 7), axis.text.y = element_text(size = 7))
quant_nmds_heat <- data_vis_qual %>%
group_by(metabolite, treatment, date) %>%
summarise(avg_nmol = mean(nmol_per_pc)) %>%
ungroup() %>%
mutate(id = paste(date, treatment))
heatmap_data <- quant_nmds_heat %>%
# group_by(metabolite) %>%
# filter(str_detect(treatment, "RH|RL|C|Tote")) %>%
# filter(avg_nmol >= 0.01) %>%
complete(metabolite, id, fill = list(avg_nmol = 0)) %>%
group_by(metabolite) %>%
mutate(norm_conc = rank(avg_nmol)) %>%
# mutate(norm_conc=(avg_nmol-min(avg_nmol))/(max(avg_nmol)-min(avg_nmol))) %>%
# mutate(norm_conc=scale(avg_nmol)[,1]) %>%
select(metabolite, norm_conc, id) %>%
pivot_wider(names_from = "metabolite", values_from = "norm_conc") %>%
mutate(id=factor(id, levels=c(heat_level_order_treat))) %>%
arrange(id) %>%
na.omit() %>%
column_to_rownames("id")
plotheatmap <- heatmap_data %>%
data.matrix() %>%
heatmaply(fontsize_row = 7, fontsize_col = 7)
library(ggcorrplot)
library(FactoMineR)
library(corrr)
plotheatmap <- heatmap_data %>%
data.matrix() %>%
heatmaply(fontsize_row = 7, fontsize_col = 7)
plotheatmap
heatmap_data <- quant_nmds_heat %>%
complete(metabolite, id, fill = list(avg_nmol = 0)) %>%
group_by(metabolite) %>%
# mutate(norm_conc = rank(avg_nmol)) %>%
mutate(norm_conc=(avg_nmol-min(avg_nmol))/(max(avg_nmol)-min(avg_nmol))) %>%
# mutate(norm_conc=scale(avg_nmol)[,1]) %>%
select(metabolite, norm_conc, id) %>%
pivot_wider(names_from = "metabolite", values_from = "norm_conc") %>%
mutate(id=factor(id, levels=c(heat_level_order_treat))) %>%
arrange(id) %>%
na.omit() %>%
column_to_rownames("id")
plotheatmap <- heatmap_data %>%
data.matrix() %>%
heatmaply(fontsize_row = 7, fontsize_col = 7)
plotheatmap
heatmap_data <- quant_nmds_heat %>%
complete(metabolite, id, fill = list(avg_nmol = 0)) %>%
group_by(metabolite) %>%
mutate(norm_conc = rank(avg_nmol)) %>%
# mutate(norm_conc=(avg_nmol-min(avg_nmol))/(max(avg_nmol)-min(avg_nmol))) %>%
# mutate(norm_conc=scale(avg_nmol)[,1]) %>%
select(metabolite, norm_conc, id) %>%
pivot_wider(names_from = "metabolite", values_from = "norm_conc") %>%
mutate(id=factor(id, levels=c(heat_level_order_treat))) %>%
arrange(id) %>%
na.omit() %>%
column_to_rownames("id")
plotheatmap <- heatmap_data %>%
data.matrix() %>%
heatmaply(fontsize_row = 7, fontsize_col = 7)
plotheatmap
quant_nmds <- data_vis_qual %>%
# arrange(desc(nM)) %>%
# group_by(metabolite, replicate) %>%
# slice(1) %>%
group_by(metabolite, treatment, date) %>%
summarise(avg_nmol = mean(nM)) %>%
ungroup() %>%
# complete(metabolite, date, treatment) %>%
# mutate(avg_nmol = replace_na(avg_nmol, 0)) %>%
mutate(id = paste(date, treatment)) %>%
filter(!str_detect(treatment, "Tote"))
quant_nmds <- data_vis_qual %>%
# arrange(desc(nM)) %>%
# group_by(metabolite, replicate) %>%
# slice(1) %>%
group_by(metabolite, treatment, date) %>%
summarise(avg_nmol = mean(nmol_per_pc)) %>%
ungroup() %>%
# complete(metabolite, date, treatment) %>%
# mutate(avg_nmol = replace_na(avg_nmol, 0)) %>%
mutate(id = paste(date, treatment)) %>%
filter(!str_detect(treatment, "Tote"))
quant_mat <- quant_nmds %>%
group_by(metabolite) %>%
mutate(norm_conc = rank(avg_nmol)) %>%
select(metabolite, norm_conc, id) %>%
pivot_wider(names_from = "metabolite", values_from = "norm_conc", values_fill = 0) %>%
column_to_rownames("id") %>%
data.matrix()
mdsout <- quant_mat %>%
metaMDS(k = 2, autotransform = FALSE)
mds_data <- metadataframe %>%
ungroup() %>%
mutate(timepoint = str_replace_all(timepoint, "July", "-7-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "June", "-6-22")) %>%
mutate(date = as.Date(timepoint, format = "%d-%m-%y")) %>%
filter(str_detect(filename, "Smp")) %>%
mutate(treatment = str_remove(treatment, "\\d")) %>%
mutate(id = paste(date, treatment))
mdsout$points %>%
as.data.frame() %>%
rownames_to_column("id") %>%
left_join(mds_data) %>%
mutate(date_fct = factor(date)) %>%
ggplot() +
geom_point(aes(x=MDS1, y=MDS2, color=factor(treatment, levels = level_order), shape = date_fct), size=4) +
scale_color_manual(values = c("plum2","mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3"),
labels = c("Control","0N:1P:1Fe, high dose P","0N:1P, low dose added", "0N:1P, high dose added",
"6N:1P, low dose added", "6N:1P, high dose added",
"16N:1P, low dose added", "16N:1P, high dose added"),
name = "Treatment") +
scale_shape_discrete(name = "Date") +
theme_bw() +
ggtitle("Variation of Metabolite Concentration (nM) Across Treatments")
View(data_vis_qual)
data_vis_qual %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc), position = "stack")
data_vis_qual %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc), position = "stack") +
facet_wrap(~treatment)
data_vis_qual %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc), position = "stack") +
facet_wrap(~treatment) +
theme_bw()
View(data_vis_qual)
data_vis_qual <- data_vis_norm %>%
left_join(metab_qual) %>%
filter(quality == "Good") %>%
mutate(ratio = str_extract(treatment, "R|L|Z|C|Tote")) %>%
mutate(rate = str_extract(treatment,  "H$|L$|C|F|Tote"))
data_vis_qual %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc), position = "stack") +
facet_grid(~rate~ratio) +
theme_bw()
data_vis_qual %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc), position = "stack") +
facet_grid(~rate~ratio) +
theme_bw()
data_vis_qual %>%
mutate(str_replace(rate, "F", "H")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc), position = "stack") +
facet_grid(~rate~ratio) +
theme_bw()
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc), position = "stack") +
facet_grid(~rate~ratio) +
theme_bw()
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(!str_detect(treatment, "Tote")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc), position = "stack") +
facet_grid(~rate~ratio) +
theme_bw()
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(!str_detect(treatment, "Tote")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc), position = "stack") +
facet_grid(~treatment) +
theme_bw()
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(!str_detect(treatment, "Tote")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc), position = "stack") +
facet_wrap(~treatment) +
theme_bw()
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(!str_detect(treatment, "Tote")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = "metabolite"), position = "stack") +
facet_wrap(~treatment) +
theme_bw()
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(!str_detect(treatment, "Tote")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = metabolite), position = "stack") +
facet_wrap(~treatment) +
theme_bw()
unique(data_vis_qual$metabolite)
nb.cols <- 56
mycolors <- colorRampPalette(brewer.pal(8, "Paired"))(nb.cols)
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(!str_detect(treatment, "Tote")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = metabolite), position = "stack") +
scale_fill_manual(values = mycolors) +
facet_wrap(~treatment) +
theme_bw()
nb.cols <- 56
nb.cols <- 57
mycolors <- colorRampPalette(brewer.pal(8, "Paired"))(nb.cols)
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(!str_detect(treatment, "Tote")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = metabolite), position = "stack") +
scale_fill_manual(values = mycolors) +
facet_wrap(~treatment) +
theme_bw()
View(data_vis_qual)
View(peri_pca_analysis)
metab_groups <- read.csv(
"https://raw.githubusercontent.com/IngallsLabUW/Ingalls_Standards/master/Ingalls_Lab_Standards.csv",
stringsAsFactors = FALSE, header = TRUE) %>%
select(metabolite = Compound_Name, emp_form = Empirical_Formula, metab_type = Compound_Type)
data_vis_qual <- data_vis_norm %>%
left_join(metab_qual) %>%
filter(quality == "Good") %>%
mutate(ratio = str_extract(treatment, "R|L|Z|C|Tote")) %>%
mutate(rate = str_extract(treatment,  "H$|L$|C|F|Tote")) %>%
left_join(metab_groups)
View(data_vis_qual)
unique(data_vis_qual$metab_type)
nb.cols <- 20
mycolors <- colorRampPalette(brewer.pal(8, "Paired"))(nb.cols)
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(!str_detect(treatment, "Tote")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = metab_type), position = "stack") +
scale_fill_manual(values = mycolors) +
facet_wrap(~treatment) +
theme_bw()
data_vis_qual <- data_vis_norm %>%
left_join(metab_qual) %>%
filter(quality == "Good") %>%
mutate(ratio = str_extract(treatment, "R|L|Z|C|Tote")) %>%
mutate(rate = str_extract(treatment,  "H$|L$|C|F|Tote")) %>%
left_join(metab_groups) %>%
filter(metab_type != "Cursed")
nb.cols <- 19
mycolors <- colorRampPalette(brewer.pal(8, "Paired"))(nb.cols)
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(!str_detect(treatment, "Tote")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = metab_type), position = "stack") +
scale_fill_manual(values = mycolors) +
facet_wrap(~treatment) +
theme_bw()
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(!str_detect(treatment, "Tote")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = metab_type), position = "fill") +
scale_fill_manual(values = mycolors) +
facet_wrap(~treatment) +
theme_bw()
metab_plot <- data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(!str_detect(treatment, "Tote")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = metab_type), position = "fill") +
scale_fill_manual(values = mycolors) +
facet_wrap(~treatment) +
theme_bw()
plotly(metab_plot)
ggplotly(metab_plot)
metab_plot <- data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(str_detect(treatment, "Tote|6-30|7-27")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = metab_type), position = "fill") +
scale_fill_manual(values = mycolors) +
facet_wrap(~treatment) +
theme_bw()
metab_plot
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(str_detect(treatment, "Tote|6-30|7-27")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = metab_type), position = "fill") +
scale_fill_manual(values = mycolors) +
facet_wrap(~treatment) +
theme_bw()
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(str_detect(treatment, "Tote|6-30|7-27"))
pcpn <- read_xlsx("metadata/peridice_pcpn.xlsx") %>%
select(tank = Tank, treatment = Treatment2, date = Date, pn = `PN (uM)`, pc = `PC (uM)`, cn = Cnratio,added_N_uM = AddN) %>%
mutate(triplicate = str_extract(tank, "\\d")) %>%
mutate(tank = str_remove (tank, "1/2|1/3|2/2"))  %>%
group_by(tank, date) %>%
mutate(pc = mean(pc)) %>%
distinct(pc, .keep_all = TRUE) %>%
mutate(pc = str_replace(pc, is.na(), "1"))
pcpn <- read_xlsx("metadata/peridice_pcpn.xlsx") %>%
select(tank = Tank, treatment = Treatment2, date = Date, pn = `PN (uM)`, pc = `PC (uM)`, cn = Cnratio,added_N_uM = AddN) %>%
mutate(triplicate = str_extract(tank, "\\d")) %>%
mutate(tank = str_remove (tank, "1/2|1/3|2/2"))  %>%
group_by(tank, date) %>%
mutate(pc = mean(pc)) %>%
distinct(pc, .keep_all = TRUE) %>%
mutate(pc = replace_na(pc, "1"))
View(pcpn)
View(pcpn)
data_vis_norm <- data_vis %>%
left_join(pcpn)
View(data_vis_norm)
View(pcpn)
data_vis <- quant_data %>%
mutate(treatment = str_extract(replicate, "Std|Poo|Blk|C|ZF|ZL|ZH|RL|RH|LL|LH|Tote1|Tote2|Tote3|Tote4")) %>%
mutate(timepoint = str_extract(replicate, "27June|30June|14July|21July|27July")) %>%
mutate(timepoint = str_replace_all(timepoint, "July", "-7-22")) %>%
mutate(timepoint = str_replace_all(timepoint, "June", "-6-22")) %>%
mutate(date = as.Date(timepoint, format = "%d-%m-%y")) %>%
select(metabolite, treatment, date, nM, replicate) %>%
filter(metabolite != "Sodium 2-mercaptoethanesulfonate") %>%
filter(metabolite != "Fumaric acid") %>%
na.omit() %>%
mutate(triplicate = str_extract(replicate, "\\d$"))
View(data_vis)
data_vis_norm <- data_vis %>%
left_join(pcpn) %>%
mutate(nmol_per_pc = nM/pc) %>%
select(replicate, metabolite, treatment, date, nM, triplicate, nmol_per_pc)
View(data_vis_norm)
data_vis_norm <- data_vis %>%
group_by(treatment, date, metabolite) %>%
mutate(nM = mean(nM))
data_vis_norm <- data_vis %>%
group_by(treatment, date, metabolite) %>%
mutate(nM = mean(nM)) %>%
left_join(pcpn) %>%
mutate(nmol_per_pc = nM/pc) %>%
select(replicate, metabolite, treatment, date, nM, triplicate, nmol_per_pc)
View(data_vis_norm)
data_vis_norm <- data_vis %>%
group_by(replicate, date, metabolite) %>%
mutate(nM = mean(nM)) %>%
left_join(pcpn) %>%
mutate(nmol_per_pc = nM/pc) %>%
select(replicate, metabolite, treatment, date, nM, triplicate, nmol_per_pc)
View(data_vis_norm)
data_vis_norm <- data_vis %>%
group_by(replicate, date, metabolite) %>%
mutate(nM = mean(nM)) %>%
left_join(pcpn) %>%
mutate(nmol_per_pc = nM/pc) %>%
select(replicate, metabolite, treatment, date, nM, triplicate, nmol_per_pc) %>%
mutate(treatment = str_remove(treatment, "$"))
View(data_vis_norm)
data_vis_norm <- data_vis %>%
group_by(replicate, date, metabolite) %>%
mutate(nM = mean(nM)) %>%
left_join(pcpn) %>%
mutate(nmol_per_pc = nM/pc) %>%
select(replicate, metabolite, treatment, date, nM, triplicate, nmol_per_pc) %>%
mutate(treatment = str_remove(treatment, "//d"))
data_vis_norm <- data_vis %>%
group_by(replicate, date, metabolite) %>%
mutate(nM = mean(nM)) %>%
left_join(pcpn) %>%
mutate(nmol_per_pc = nM/pc) %>%
select(replicate, metabolite, treatment, date, nM, triplicate, nmol_per_pc) %>%
mutate(treatment = str_remove(treatment, "\\d"))
metab_groups <- read.csv(
"https://raw.githubusercontent.com/IngallsLabUW/Ingalls_Standards/master/Ingalls_Lab_Standards.csv",
stringsAsFactors = FALSE, header = TRUE) %>%
select(metabolite = Compound_Name, emp_form = Empirical_Formula, metab_type = Compound_Type)
data_vis_qual <- data_vis_norm %>%
left_join(metab_qual) %>%
filter(quality == "Good") %>%
mutate(ratio = str_extract(treatment, "R|L|Z|C|Tote")) %>%
mutate(rate = str_extract(treatment,  "H$|L$|C|F|Tote")) %>%
left_join(metab_groups) %>%
filter(metab_type != "Cursed")
View(data_vis_qual)
data_vis_qual <- data_vis_norm %>%
left_join(metab_qual) %>%
filter(quality == "Good") %>%
mutate(ratio = str_extract(treatment, "R|L|Z|C|Tote")) %>%
mutate(rate = str_extract(treatment,  "H$|L$|C|F|Tote")) %>%
left_join(metab_groups) %>%
filter(metab_type != "Cursed") %>%
na.omit()
View(data_vis_qual)
nb.cols <- 19
mycolors <- colorRampPalette(brewer.pal(8, "Paired"))(nb.cols)
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(str_detect(treatment, "Tote|6-30|7-27")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = metab_type), position = "fill") +
scale_fill_manual(values = mycolors) +
facet_wrap(~treatment) +
theme_bw()
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(str_detect(treatment, "Tote|6-30|7-27"))
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(str_detect(treatment, "Tote|30June|27July")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = metab_type), position = "fill") +
scale_fill_manual(values = mycolors) +
facet_wrap(~treatment) +
theme_bw()
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(str_detect(treatment, "Tote|30June|27July")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = metab_type), position = "fill") +
scale_fill_manual(values = mycolors) +
facet_wrap(~treatment) +
theme_bw()
messy <- data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(str_detect(treatment, "Tote|30June|27July"))
View(data_vis_qual)
view(messy)
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(str_detect(replicate, "Tote|30June|27July")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = metab_type), position = "fill") +
scale_fill_manual(values = mycolors) +
facet_wrap(~treatment) +
theme_bw()
data_vis_qual %>%
mutate(rate = str_replace(rate, "F", "H")) %>%
filter(str_detect(replicate, "Tote|30June|27July")) %>%
ggplot() +
geom_col(aes(x = date, y = nmol_per_pc, fill = metab_type), position = "stack") +
scale_fill_manual(values = mycolors) +
facet_wrap(~treatment) +
theme_bw()
# Chunk 1
library(tidyverse)
library(ggplot2)
library(RColorBrewer)
library(plotly)
library(vegan)
library(heatmaply)
library(ggnewscale)
library(readr)
library(readxl)
library(corrr)
library(ggcorrplot)
library(FactoMineR)
library(stats)
library(ggfortify)
library(ggh4x)
set.seed(20)
# Chunk 2
quant_data <- read_csv("csvs/quant_data.csv") %>%
filter(nM > 0) %>%
filter(nM < 100)
metadataframe <- read_csv("csvs/metadataframe.csv")
pcpn <- read_xlsx("metadata/peridice_pcpn.xlsx") %>%
select(tank = Tank, treatment = Treatment2, date = Date, pn = `PN (uM)`, pc = `PC (uM)`, cn = Cnratio,added_N_uM = AddN) %>%
mutate(triplicate = str_extract(tank, "\\d")) %>%
mutate(tank = str_remove (tank, "1/2|1/3|2/2"))  %>%
group_by(tank, date) %>%
mutate(pc = mean(pc)) %>%
distinct(pc, .keep_all = TRUE) %>%
mutate(timepoint = )

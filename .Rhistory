facet_wrap(~date)
peri_phospho %>%
filter(metabolite == "Glycerophosphocholine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date)
peri_phospho %>%
filter(metabolite == "Glycerophosphocholine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date, scales = "free")
peri_phospho %>%
filter(metabolite == "Glycerophosphocholine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_per_pc, color = metabolite)) +
facet_wrap(~date, scales = "free")
peri_phospho %>%
filter(metabolite == "Glycerophosphocholine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_per_pc, color = metabolite)) +
facet_wrap(~date)
peri_phospho %>%
# filter(metabolite == "Glycerophosphocholine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_per_pc, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
## k means
peri_km <- peri %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate")) %>%
ungroup() %>%
distinct(nmol, .keep_all = TRUE) %>%
select(metabolite, nmol, filename)  %>%
pivot_wider(names_from = metabolite, values_from = nmol) %>%
column_to_rownames("filename") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
scale() %>%
t() %>%
kmeans(centers = 10) %>%
pluck("cluster") %>%
as.data.frame() %>%
set_names("cluster") %>%
rownames_to_column("metabolite")
View(peri_km)
peri_phospho %>%
filter(metabolite == "Glycerophosphocholine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_per_pc, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri_sulf <- peri %>%
left_join(metab_groups) %>%
distinct(nmol, .keep_all = TRUE) %>%
filter(str_detect(emp_form, "S"))
peri_sulf %>%
# filter(metabolite == "Glycerophosphocholine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_per_pc, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri_sulf %>%
filter(metabolite == "Dimethylsulfoniopropionate") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol_per_pc, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri_phospho %>%
filter(metabolite == "Glycerophosphocholine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri_sulf %>%
filter(metabolite == "Dimethylsulfoniopropionate") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri_cluster <- peri %>%
left_join(peri_km)
View(peri_cluster)
peri_cluster %>%
group_by(cluster, treatment, date) %>%
mutate(nmol = mean(nmol)) %>%
ggplot(aes(x = date, y = nmol, color = treatment)) +
geom_point() +
geom_line() +
facet_wrap(~cluster)
peri_km <- peri %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate")) %>%
ungroup() %>%
distinct(nmol, .keep_all = TRUE) %>%
select(metabolite, nmol, filename)  %>%
pivot_wider(names_from = metabolite, values_from = nmol) %>%
column_to_rownames("filename") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
scale() %>%
t() %>%
kmeans(centers = 6) %>%
pluck("cluster") %>%
as.data.frame() %>%
set_names("cluster") %>%
rownames_to_column("metabolite")
peri_cluster <- peri %>%
left_join(peri_km)
peri_cluster %>%
group_by(cluster, treatment, date) %>%
mutate(nmol = mean(nmol)) %>%
ggplot(aes(x = date, y = nmol, color = treatment)) +
geom_point() +
geom_line() +
facet_wrap(~cluster)
peri_km <- peri %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate")) %>%
ungroup() %>%
distinct(nmol, .keep_all = TRUE) %>%
select(metabolite, nmol_per_pc, filename)  %>%
pivot_wider(names_from = metabolite, values_from = nmol_per_pc) %>%
column_to_rownames("filename") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
scale() %>%
t() %>%
kmeans(centers = 6) %>%
pluck("cluster") %>%
as.data.frame() %>%
set_names("cluster") %>%
rownames_to_column("metabolite")
peri_cluster <- peri %>%
left_join(peri_km)
peri_cluster %>%
group_by(cluster, treatment, date) %>%
mutate(nmol = mean(nmol)) %>%
ggplot(aes(x = date, y = nmol, color = treatment)) +
geom_point() +
geom_line() +
facet_wrap(~cluster)
peri_km <- peri %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate")) %>%
ungroup() %>%
distinct(nmol, .keep_all = TRUE) %>%
select(metabolite, nmol, filename)  %>%
pivot_wider(names_from = metabolite, values_from = nmol) %>%
column_to_rownames("filename") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
scale() %>%
t() %>%
kmeans(centers = 6) %>%
pluck("cluster") %>%
as.data.frame() %>%
set_names("cluster") %>%
rownames_to_column("metabolite")
peri_cluster <- peri %>%
left_join(peri_km)
peri_cluster %>%
group_by(cluster, treatment, date) %>%
mutate(nmol = mean(nmol)) %>%
ggplot(aes(x = date, y = nmol, color = treatment)) +
geom_point() +
geom_line() +
facet_wrap(~cluster)
peri_cluster %>%
group_by(cluster, treatment, date) %>%
mutate(nmol = mean(nmol)) %>%
ggplot(aes(x = date, y = nmol,
color = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")))) +
geom_point() +
geom_line() +
scale_color_manual(name = "Treatment", values = c("plum2","mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3"))
peri_cluster %>%
group_by(cluster, treatment, date) %>%
mutate(nmol = mean(nmol)) %>%
ggplot(aes(x = date, y = nmol,
color = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")))) +
geom_point() +
geom_line() +
scale_color_manual(name = "Treatment", values = c("plum2","mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3")) +
facet_wrap(~cluster)
peri_fc <- peri %>%
select(-c("replicate")) %>%
filter(!str_detect(treatment, "Tote")) %>%
pivot_wider(names_from = treatment, values_from = nM, values_fn = mean) %>%
pivot_longer(cols = c(ZF, ZL, ZH, LL, LH, RL, RH)) %>%
mutate(fold_change = value/C)
peri_fc <- peri %>%
filter(!str_detect(treatment, "Tote")) %>%
pivot_wider(names_from = treatment, values_from = nM, values_fn = mean) %>%
pivot_longer(cols = c(ZF, ZL, ZH, LL, LH, RL, RH)) %>%
mutate(fold_change = value/C)
peri_fc <- peri %>%
filter(!str_detect(treatment, "Tote")) %>%
pivot_wider(names_from = treatment, values_from = nmol, values_fn = mean) %>%
pivot_longer(cols = c(ZF, ZL, ZH, LL, LH, RL, RH)) %>%
mutate(fold_change = value/C)
View(peri_fc)
peri_km <- peri %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate")) %>%
ungroup() %>%
distinct(nmol, .keep_all = TRUE) %>%
select(metabolite, nmol, filename)  %>%
pivot_wider(names_from = metabolite, values_from = nmol) %>%
column_to_rownames("filename") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
scale() %>%
t() %>%
kmeans(centers = 6) %>%
pluck("cluster") %>%
as.data.frame() %>%
set_names("cluster") %>%
rownames_to_column("metabolite")
peri_fc <- peri %>%
filter(!str_detect(treatment, "Tote")) %>%
group_by(metabolite, treatment, date) %>%
mutate(mean = mean(nmol)) %>%
pivot_wider(names_from = treatment, values_from = nmol, values_fn = mean) %>%
pivot_longer(cols = c(ZF, ZL, ZH, LL, LH, RL, RH)) %>%
mutate(fold_change = value/C)
View(peri_fc)
peri_fc <- peri %>%
filter(!str_detect(treatment, "Tote")) %>%
# group_by(metabolite, treatment, date) %>%
# mutate(mean = mean(nmol)) %>%
pivot_wider(names_from = treatment, values_from = nmol, values_fn = mean) %>%
pivot_longer(cols = c(ZF, ZL, ZH, LL, LH, RL, RH)) %>%
mutate(fold_change = value/C)
View(peri_fc)
peri_fc <- peri %>%
filter(!str_detect(treatment, "Tote")) %>%
pivot_wider(names_from = treatment, values_from = nmol, values_fn = mean)
View(peri_fc)
View(peri_fc)
peri_fc <- peri %>%
filter(!str_detect(treatment, "Tote")) %>%
pivot_wider(names_from = treatment, values_from = nmol, values_fn = mean) %>%
pivot_longer(cols = c(ZF, ZL, ZH, LL, LH, RL, RH))
View(peri_fc)
peri_cluster <- peri %>%
left_join(peri_km)
peri_cluster <- peri_fc %>%
left_join(peri_km)
peri_cluster <- peri_fc %>%
left_join(peri_km) %>%
rename(control = C, treatment = name, nmol = value) %>%
mutate(cluster = factor(cluster)) %>%
na.omit()
View(peri_cluster)
View(peri_cluster)
peri_cluster <- peri_fc %>%
left_join(peri_km, by ="metabolite") %>%
rename(control = C, treatment = name, nmol = value)
View(peri_cluster)
peri_cluster <- peri_fc %>%
left_join(peri_km, by ="metabolite") %>%
rename(control = C, treatment = name, nmol = value) %>%
mutate(cluster = factor(cluster))
peri_cluster <- peri_fc %>%
left_join(peri_km, by ="metabolite") %>%
rename(control = C, treatment = name, nmol = value) %>%
mutate(cluster = factor(cluster)) %>%
na.omit()
peri_cluster <- peri_fc %>%
left_join(peri_km, by ="metabolite") %>%
rename(control = C, treatment = name, nmol = value) %>%
mutate(cluster = factor(cluster))
peri_km <- peri %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate")) %>%
ungroup() %>%
distinct(nmol, .keep_all = TRUE) %>%
select(metabolite, nmol, filename)  %>%
pivot_wider(names_from = metabolite, values_from = nmol) %>%
column_to_rownames("filename") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
scale() %>%
t() %>%
kmeans(centers = 6) %>%
pluck("cluster") %>%
as.data.frame() %>%
set_names("cluster") %>%
rownames_to_column("metabolite")
View(peri_km)
peri_km %>%
ggplot() +
geom_boxplot(aes(x = factor(date), y = nmol, color = metabolite)) +
facet_wrap(~cluster)
peri_km %>%
ggplot() +
geom_boxplot(aes(x = factor(date), y = nmol, color = metabolite)) +
facet_wrap(~cluster)
peri_cluster <- peri %>%
left_join(peri_km, by ="metabolite")
peri_km %>%
ggplot() +
geom_boxplot(aes(x = factor(date), y = nmol, color = metabolite)) +
facet_wrap(~cluster)
View(peri_cluster)
peri_cluster %>%
ggplot() +
geom_boxplot(aes(x = factor(date), y = nmol, color = metabolite)) +
facet_wrap(~cluster)
peri_cluster %>%
ggplot() +
geom_boxplot(aes(x = factor(date), y = nmol, color = metabolite)) +
facet_wrap(~cluster) +
theme(legend.position = "none")
peri_cluster %>%
ggplot() +
geom_boxplot(aes(x = factor(date), y = nmol, color = metabolite)) +
facet_wrap(~cluster, scales = "free") +
theme(legend.position = "none")
peri_km <- peri %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate")) %>%
ungroup() %>%
distinct(nmol, .keep_all = TRUE) %>%
select(metabolite, nmol, filename)  %>%
pivot_wider(names_from = metabolite, values_from = nmol) %>%
column_to_rownames("filename") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
scale() %>%
t() %>%
kmeans(centers = 10) %>%
pluck("cluster") %>%
as.data.frame() %>%
set_names("cluster") %>%
rownames_to_column("metabolite")
peri_cluster <- peri %>%
left_join(peri_km, by ="metabolite")
peri_cluster %>%
ggplot() +
geom_boxplot(aes(x = factor(date), y = nmol, color = metabolite)) +
facet_wrap(~cluster, scales = "free") +
theme(legend.position = "none")
peri_cluster %>%
ggplot() +
geom_boxplot(aes(x = factor(date), y = nmol, color = treatment)) +
facet_wrap(~cluster, scales = "free") +
theme(legend.position = "none")
peri_cluster %>%
ggplot() +
geom_boxplot(aes(x = factor(date), y = nmol, color = treatment)) +
facet_wrap(~cluster, scales = "free")
peri_cluster %>%
group_by(cluster, treatment, date) %>%
mutate(nmol = mean(nmol)) %>%
ggplot(aes(x = date, y = nmol,
color = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")))) +
geom_point() +
geom_line() +
scale_color_manual(name = "Treatment",
values = c("plum2","mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3")) +
facet_wrap(~cluster)
peri_km <- peri %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate")) %>%
ungroup() %>%
distinct(nmol, .keep_all = TRUE) %>%
select(metabolite, nmol, filename)  %>%
pivot_wider(names_from = metabolite, values_from = nmol_per_pc) %>%
column_to_rownames("filename") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
scale() %>%
t() %>%
kmeans(centers = 10) %>%
pluck("cluster") %>%
as.data.frame() %>%
set_names("cluster") %>%
rownames_to_column("metabolite")
View(peri)
peri_km <- peri %>%
filter(!str_detect(metabolite, "Amino hydroxypropanesulfonate")) %>%
ungroup() %>%
distinct(nmol, .keep_all = TRUE) %>%
select(metabolite, nmol_per_pc, filename)  %>%
pivot_wider(names_from = metabolite, values_from = nmol_per_pc) %>%
column_to_rownames("filename") %>%
data.matrix() %>%
`[<-`(is.na(.), 0) %>%
scale() %>%
t() %>%
kmeans(centers = 10) %>%
pluck("cluster") %>%
as.data.frame() %>%
set_names("cluster") %>%
rownames_to_column("metabolite")
peri_cluster <- peri %>%
left_join(peri_km, by ="metabolite")
peri_cluster %>%
group_by(cluster, treatment, date) %>%
mutate(nmol = mean(nmol)) %>%
ggplot(aes(x = date, y = nmol,
color = factor(treatment, levels = c("C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")))) +
geom_point() +
geom_line() +
scale_color_manual(name = "Treatment",
values = c("plum2","mediumpurple3","darkslategray2", "lightseagreen","gold", "lightcoral","orange", "brown3")) +
facet_wrap(~cluster)
peri_phospho %>%
filter(metabolite == "Glycerophosphocholine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri_sulf %>%
filter(metabolite == "Dimethylsulfoniopropionate") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri_sulf %>%
filter(metabolite == "Gonyol") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri_sulf %>%
filter(metabolite == "Dimethylsulfoniopropionate") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
View(peri)
peri %>%
filter(metabolite == "Uracil") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri %>%
filter(metabolite == "L-Cysteic acid") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri %>%
filter(metabolite == "5-Oxoproline") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
View(peri)
peri %>%
filter(metabolite == "Pipecolic acid") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
View(peri)
peri %>%
filter(metabolite == "Butyrylcarnitine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri %>%
filter(metabolite == "Arsenobetaine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri %>%
filter(metabolite == "L−Cysteinylglycine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri %>%
filter(metabolite == "L−Cysteine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri %>%
filter(metabolite == "N6,N6,N6−Trimethyl−L−lysine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))
peri %>%
filter(metabolite == "O-Acetylcarnitine") %>%
ggplot() +
geom_boxplot(aes(x = factor(treatment, levels = c("Tote", "C", "ZL", "ZF", "ZH", "LL", "LH", "RL", "RH")),
y = nmol, color = metabolite)) +
facet_wrap(~date) +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5))

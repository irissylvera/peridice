"0","peak_data_long <- msnexp_filled %>%"
"0","  chromPeaks() %>%"
"0","  as.data.frame() %>%"
"0","  rownames_to_column() %>%"
"0","  mutate(peakidx=row_number())"
"0","peak_data <- msnexp_filled %>%"
"0","  featureDefinitions() %>%"
"0","  as.data.frame() %>%"
"0","  select(mzmed, rtmed, npeaks, peakidx) %>%"
"0","  rownames_to_column(""id"") %>%"
"0","  unnest_longer(peakidx) %>%"
"0","  rename_with(~paste0(""feat_"", .x), .cols = -peakidx) %>%"
"0","  left_join(peak_data_long) %>%"
"0","  mutate(filename=basename(fileNames(msnexp_filled))[sample]) %>% "
"0","  left_join(metadataframe %>% mutate(filename=basename(filename))) %>%"
"0","  filter(samp_type==""Smp"")"
"2","Joining with `by = join_by(peakidx)`"
"2","Joining with `by = join_by(filename)`"
